/*! For license information please see zotero-ner-bundled.js.LICENSE.txt */
!function(e,u){"object"==typeof exports&&"object"==typeof module?module.exports=u():"function"==typeof define&&define.amd?define([],u):"object"==typeof exports?exports.ZoteroNER=u():e.ZoteroNER=u()}(this,()=>(()=>{var e={22:(e,u,t)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,u){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=D(e))||u&&e&&"number"==typeof e.length){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,a=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw a}}}}function a(){var e,u,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",n=t.toStringTag||"@@toStringTag";function i(t,r,n,a){var i=r&&r.prototype instanceof s?r:s,c=Object.create(i.prototype);return o(c,"_invoke",function(t,r,n){var a,o,i,s=0,c=n||[],l=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(u,t){return a=u,o=0,i=e,f.n=t,D}};function p(t,r){for(o=t,i=r,u=0;!l&&s&&!n&&u<c.length;u++){var n,a=c[u],p=f.p,y=a[2];t>3?(n=y===r)&&(i=a[(o=a[4])?5:(o=3,3)],a[4]=a[5]=e):a[0]<=p&&((n=t<2&&p<a[1])?(o=0,f.v=r,f.n=a[1]):p<y&&(n=t<3||a[0]>r||r>y)&&(a[4]=t,a[5]=r,f.n=y,o=0))}if(n||t>1)return D;throw l=!0,r}return function(n,c,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===c&&p(c,y),o=c,i=y;(u=o<2?e:i)||!l;){a||(o?o<3?(o>1&&(f.n=-1),p(o,i)):f.n=i:f.v=i);try{if(s=2,a){if(o||(n="next"),u=a[n]){if(!(u=u.call(a,i)))throw TypeError("iterator result is not an object");if(!u.done)return u;i=u.value,o<2&&(o=0)}else 1===o&&(u=a.return)&&u.call(a),o<2&&(i=TypeError("The iterator does not provide a '"+n+"' method"),o=1);a=e}else if((u=(l=f.n<0)?i:t.call(r,f))!==D)break}catch(u){a=e,o=1,i=u}finally{s=1}}return{value:u,done:l}}}(t,n,a),!0),c}var D={};function s(){}function c(){}function l(){}u=Object.getPrototypeOf;var f=[][r]?u(u([][r]())):(o(u={},r,function(){return this}),u),p=l.prototype=s.prototype=Object.create(f);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,o(e,n,"GeneratorFunction")),e.prototype=Object.create(p),e}return c.prototype=l,o(p,"constructor",l),o(l,"constructor",c),c.displayName="GeneratorFunction",o(l,n,"GeneratorFunction"),o(p),o(p,n,"Generator"),o(p,r,function(){return this}),o(p,"toString",function(){return"[object Generator]"}),(a=function(){return{w:i,m:y}})()}function o(e,u,t,r){var n=Object.defineProperty;try{n({},"",{})}catch(e){n=0}o=function(e,u,t,r){function a(u,t){o(e,u,function(e){return this._invoke(u,t,e)})}u?n?n(e,u,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[u]=t:(a("next",0),a("throw",1),a("return",2))},o(e,u,t,r)}function i(e,u){return function(e){if(Array.isArray(e))return e}(e)||function(e,u){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,n,a,o,i=[],D=!0,s=!1;try{if(a=(t=t.call(e)).next,0===u){if(Object(t)!==t)return;D=!1}else for(;!(D=(r=a.call(t)).done)&&(i.push(r.value),i.length!==u);D=!0);}catch(e){s=!0,n=e}finally{try{if(!D&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(s)throw n}}return i}}(e,u)||D(e,u)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,u){if(e){if("string"==typeof e)return s(e,u);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?s(e,u):void 0}}function s(e,u){(null==u||u>e.length)&&(u=e.length);for(var t=0,r=Array(u);t<u;t++)r[t]=e[t];return r}function c(e,u,t,r,n,a,o){try{var i=e[a](o),D=i.value}catch(e){return void t(e)}i.done?u(D):Promise.resolve(D).then(r,n)}function l(e){return function(){var u=this,t=arguments;return new Promise(function(r,n){var a=e.apply(u,t);function o(e){c(a,r,n,o,i,"next",e)}function i(e){c(a,r,n,o,i,"throw",e)}o(void 0)})}}function f(e,u){for(var t=0;t<u.length;t++){var r=u[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function p(e){var u=function(e){if("object"!=r(e)||!e)return e;var u=e[Symbol.toPrimitive];if(void 0!==u){var t=u.call(e,"string");if("object"!=r(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(u)?u:u+""}var y=function(){return e=function e(){!function(e,u){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this,e),this.nerProcessor=new(t(388)),this.learningEngine=new(t(95)),this.nameParser=new(t(889)),this.variantGenerator=new(t(441))},u=[{key:"findNameVariants",value:(c=l(a().m(function e(u){var t,r,n,o,D,s,c,l,f,p,y;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:if(u){e.n=1;break}throw new Error("Zotero database object required for candidate finding");case 1:return e.p=1,e.n=2,this.fetchAllCreators(u);case 2:for(t=e.v,r=this.groupCreatorsBySurname(t),n={},o=0,D=0,s=Object.entries(r);D<s.length;D++)c=i(s[D],2),l=c[0],f=c[1],(p=this.findFirstInitialVariations(f)).length>0&&(n[l]=p,o+=p.length);return e.a(2,{surnameGroups:r,variationsBySurname:n,totalVariantGroups:o,totalSurnames:Object.keys(r).length});case 3:throw e.p=3,y=e.v,console.error("Error in findNameVariants:",y),y;case 4:return e.a(2)}},e,this,[[1,3]])})),function(e){return c.apply(this,arguments)})},{key:"fetchAllCreators",value:(s=l(a().m(function e(u){var t,r,o,i,D,s,c,l,f;return a().w(function(e){for(;;)switch(e.n){case 0:if("undefined"==typeof Zotero){e.n=2;break}return t=[],e.n=1,Zotero.Items.getAll();case 1:r=e.v,o=n(r);try{for(o.s();!(i=o.n()).done;){D=i.value,s=D.getCreators(),c=n(s);try{for(c.s();!(l=c.n()).done;)f=l.value,t.push(f)}catch(e){c.e(e)}finally{c.f()}}}catch(e){o.e(e)}finally{o.f()}return e.a(2,t);case 2:return e.a(2,[{firstName:"Jerry",lastName:"Fodor",creatorType:"author"},{firstName:"J.",lastName:"Fodor",creatorType:"author"},{firstName:"Jerry",lastName:"Fodor",creatorType:"author"},{firstName:"Jerry A.",lastName:"Fodor",creatorType:"author"},{firstName:"J.A.",lastName:"Fodor",creatorType:"author"},{firstName:"Eva",lastName:"van Dijk",creatorType:"author"},{firstName:"E.",lastName:"van Dijk",creatorType:"author"},{firstName:"John",lastName:"Smith",creatorType:"author"},{firstName:"J.",lastName:"Smith",creatorType:"author"},{firstName:"Johnny",lastName:"Smith",creatorType:"author"},{firstName:"J.B.",lastName:"Smith",creatorType:"author"},{firstName:"John B.",lastName:"Smith",creatorType:"author"}]);case 3:return e.a(2)}},e)})),function(e){return s.apply(this,arguments)})},{key:"groupCreatorsBySurname",value:function(e){var u,t={},r=n(e);try{for(r.s();!(u=r.n()).done;){var a=u.value,o=this.nameParser.parse("".concat(a.firstName||""," ").concat(a.lastName||"").trim());if(o.lastName){var i=o.lastName.toLowerCase().trim();t[i]||(t[i]=[]),t[i].push(a)}}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"findFirstInitialVariations",value:function(e){var u,t={},r={},a=n(e);try{for(a.s();!(u=a.n()).done;){var o=u.value,i="".concat(o.firstName||""," ").concat(o.lastName||"").trim().toLowerCase();t[i]=(t[i]||0)+1,r[i]||(r[i]=o)}}catch(e){a.e(e)}finally{a.f()}var D,s={},c=n(e);try{for(c.s();!(D=c.n()).done;){var l=(D.value.firstName||"").trim().toLowerCase();l&&(s[l]||(s[l]=0),s[l]++)}}catch(e){c.e(e)}finally{c.f()}for(var f=Object.keys(s),p=[],y=0;y<f.length;y++)for(var m=y+1;m<f.length;m++){var F=f[y],h=f[m],v=this.calculateLevenshteinDistance(F,h),A=Math.max(F.length,h.length),C=A>0?1-v/A:1;C>=.6&&p.push({surname:e[0].lastName,variant1:{firstName:F,frequency:s[F]},variant2:{firstName:h,frequency:s[h]},similarity:C,distance:v})}return p.sort(function(e,u){var t=e.variant1.frequency+e.variant2.frequency;return u.variant1.frequency+u.variant2.frequency-t}),p}},{key:"findCanonicalForms",value:function(e){for(var u={},t=0,r=Object.entries(e);t<r.length;t++){var a,o=i(r[t],2),D=(o[0],n(o[1]));try{for(D.s();!(a=D.n()).done;){var s=a.value,c=s.variant1.frequency>=s.variant2.frequency?s.variant1.firstName:s.variant2.firstName,l="".concat(s.variant1.firstName," ").concat(s.surname).trim(),f="".concat(s.variant2.firstName," ").concat(s.surname).trim(),p="".concat(c," ").concat(s.surname).trim();u[l.toLowerCase()]=p,u[f.toLowerCase()]=p}}catch(e){D.e(e)}finally{D.f()}}return u}},{key:"calculateLevenshteinDistance",value:function(e,u){var t=[];if(0===e.length)return u.length;if(0===u.length)return e.length;for(var r=0;r<=u.length;r++)t[r]=[r];for(var n=0;n<=e.length;n++)t[0][n]=n;for(var a=1;a<=u.length;a++)for(var o=1;o<=e.length;o++)u.charAt(a-1)===e.charAt(o-1)?t[a][o]=t[a-1][o-1]:t[a][o]=Math.min(t[a-1][o-1]+1,t[a][o-1]+1,t[a-1][o]+1);return t[u.length][e.length]}},{key:"performFullAnalysis",value:(D=l(a().m(function e(u){var t,r,n;return a().w(function(e){for(;;)switch(e.n){case 0:return console.log("Starting full name variant analysis (first name/initial focus)..."),e.n=1,this.findNameVariants(u);case 1:return t=e.v,r=this.findCanonicalForms(t.variationsBySurname),e.n=2,this.generateNormalizationSuggestions(t.variationsBySurname,r);case 2:return n=e.v,console.log("Analysis complete: Found ".concat(t.totalVariantGroups," variant groups across ").concat(t.totalSurnames," surnames")),e.a(2,{surnameGroups:t.surnameGroups,variationsBySurname:t.variationsBySurname,canonicalForms:r,suggestions:n,totalVariantGroups:t.totalVariantGroups,totalSurnamesAnalyzed:t.totalSurnames})}},e,this)})),function(e){return D.apply(this,arguments)})},{key:"generateNormalizationSuggestions",value:(o=l(a().m(function e(u,t){var r,o,D,s,c,l,f,p,y,m;return a().w(function(e){for(;;)if(0===e.n){for(r=[],o=0,D=Object.entries(u);o<D.length;o++){(s=i(D[o],2))[0],c=s[1],l=n(c);try{for(l.s();!(f=l.n()).done;)p=f.value,y="".concat(p.variant1.firstName," ").concat(p.surname).trim(),m="".concat(p.variant2.firstName," ").concat(p.surname).trim(),r.push({surname:p.surname,canonicalForm:t[y.toLowerCase()]||t[m.toLowerCase()],variant1:{firstName:p.variant1.firstName,frequency:p.variant1.frequency},variant2:{firstName:p.variant2.firstName,frequency:p.variant2.frequency},similarity:p.similarity,recommendedNormalization:p.variant1.frequency>=p.variant2.frequency?p.variant1.firstName:p.variant2.firstName})}catch(e){l.e(e)}finally{l.f()}}return e.a(2,r)}},e)})),function(e,u){return o.apply(this,arguments)})},{key:"getAllVariations",value:(r=l(a().m(function e(u){var t;return a().w(function(e){for(;;)if(0===e.n)return t=this.nameParser.parse(u),e.a(2,this.variantGenerator.generateVariants(t))},e,this)})),function(e){return r.apply(this,arguments)})}],u&&f(e.prototype,u),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,u,r,o,D,s,c}();e.exports&&(e.exports=y)},48:(e,u,t)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(){var e,u,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function i(t,r,n,o){var i=r&&r.prototype instanceof s?r:s,c=Object.create(i.prototype);return a(c,"_invoke",function(t,r,n){var a,o,i,s=0,c=n||[],l=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(u,t){return a=u,o=0,i=e,f.n=t,D}};function p(t,r){for(o=t,i=r,u=0;!l&&s&&!n&&u<c.length;u++){var n,a=c[u],p=f.p,y=a[2];t>3?(n=y===r)&&(i=a[(o=a[4])?5:(o=3,3)],a[4]=a[5]=e):a[0]<=p&&((n=t<2&&p<a[1])?(o=0,f.v=r,f.n=a[1]):p<y&&(n=t<3||a[0]>r||r>y)&&(a[4]=t,a[5]=r,f.n=y,o=0))}if(n||t>1)return D;throw l=!0,r}return function(n,c,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===c&&p(c,y),o=c,i=y;(u=o<2?e:i)||!l;){a||(o?o<3?(o>1&&(f.n=-1),p(o,i)):f.n=i:f.v=i);try{if(s=2,a){if(o||(n="next"),u=a[n]){if(!(u=u.call(a,i)))throw TypeError("iterator result is not an object");if(!u.done)return u;i=u.value,o<2&&(o=0)}else 1===o&&(u=a.return)&&u.call(a),o<2&&(i=TypeError("The iterator does not provide a '"+n+"' method"),o=1);a=e}else if((u=(l=f.n<0)?i:t.call(r,f))!==D)break}catch(u){a=e,o=1,i=u}finally{s=1}}return{value:u,done:l}}}(t,n,o),!0),c}var D={};function s(){}function c(){}function l(){}u=Object.getPrototypeOf;var f=[][r]?u(u([][r]())):(a(u={},r,function(){return this}),u),p=l.prototype=s.prototype=Object.create(f);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,a(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return c.prototype=l,a(p,"constructor",l),a(l,"constructor",c),c.displayName="GeneratorFunction",a(l,o,"GeneratorFunction"),a(p),a(p,o,"Generator"),a(p,r,function(){return this}),a(p,"toString",function(){return"[object Generator]"}),(n=function(){return{w:i,m:y}})()}function a(e,u,t,r){var n=Object.defineProperty;try{n({},"",{})}catch(e){n=0}a=function(e,u,t,r){function o(u,t){a(e,u,function(e){return this._invoke(u,t,e)})}u?n?n(e,u,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[u]=t:(o("next",0),o("throw",1),o("return",2))},a(e,u,t,r)}function o(e,u){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);u&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),t.push.apply(t,r)}return t}function i(e){for(var u=1;u<arguments.length;u++){var t=null!=arguments[u]?arguments[u]:{};u%2?o(Object(t),!0).forEach(function(u){D(e,u,t[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach(function(u){Object.defineProperty(e,u,Object.getOwnPropertyDescriptor(t,u))})}return e}function D(e,u,t){return(u=y(u))in e?Object.defineProperty(e,u,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[u]=t,e}function s(e,u){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,u){if(e){if("string"==typeof e)return c(e,u);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(e,u):void 0}}(e))||u&&e&&"number"==typeof e.length){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,a=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw a}}}}function c(e,u){(null==u||u>e.length)&&(u=e.length);for(var t=0,r=Array(u);t<u;t++)r[t]=e[t];return r}function l(e,u,t,r,n,a,o){try{var i=e[a](o),D=i.value}catch(e){return void t(e)}i.done?u(D):Promise.resolve(D).then(r,n)}function f(e){return function(){var u=this,t=arguments;return new Promise(function(r,n){var a=e.apply(u,t);function o(e){l(a,r,n,o,i,"next",e)}function i(e){l(a,r,n,o,i,"throw",e)}o(void 0)})}}function p(e,u){for(var t=0;t<u.length;t++){var r=u[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y(r.key),r)}}function y(e){var u=function(e){if("object"!=r(e)||!e)return e;var u=e[Symbol.toPrimitive];if(void 0!==u){var t=u.call(e,"string");if("object"!=r(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(u)?u:u+""}var m=function(){return e=function e(){!function(e,u){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this,e),this.nameParser=new(t(889)),this.variantGenerator=new(t(441)),this.learningEngine=new(t(95)),this.candidateFinder=new(t(22))},u=[{key:"processItemCreators",value:(D=f(n().m(function e(u){var t,r,a,o,D,c,l,f,p,y,m,F;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:t=[],r=u.getCreators?u.getCreators():[],a=s(r),e.p=1,a.s();case 2:if((o=a.n()).done){e.n=6;break}if(!(D=o.value).firstName&&!D.lastName){e.n=5;break}if(c=this.buildRawName(D),!(l=this.learningEngine.getMapping(c))){e.n=3;break}return t.push({original:i({},D),normalized:this.parseNameFromFullString(l),type:D.creatorType,status:"learned",suggestion:l}),e.a(3,5);case 3:return f=this.learningEngine.findSimilar(c),p=this.nameParser.parse(c),y=this.variantGenerator.generateVariants(p),e.n=4,this.findLibraryWideVariants(p.lastName);case 4:m=e.v,t.push({original:i({},D),parsed:p,variants:y,similars:f,libraryVariants:m,type:D.creatorType,status:"new"});case 5:e.n=2;break;case 6:e.n=8;break;case 7:e.p=7,F=e.v,a.e(F);case 8:return e.p=8,a.f(),e.f(8);case 9:return e.a(2,t)}},e,this,[[1,7,8,9]])})),function(e){return D.apply(this,arguments)})},{key:"findLibraryWideVariants",value:(o=f(n().m(function e(u){var t;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if("undefined"==typeof Zotero){e.n=3;break}return e.p=1,e.a(2,[]);case 2:return e.p=2,t=e.v,console.warn("Could not perform library-wide variant scan:",t),e.a(2,[]);case 3:return e.a(2,[])}},e,null,[[1,2]])})),function(e){return o.apply(this,arguments)})},{key:"buildRawName",value:function(e){return"".concat(e.firstName||""," ").concat(e.lastName||"").trim()}},{key:"parseNameFromFullString",value:function(e){var u=this.nameParser.parse(e);return{firstName:u.firstName,lastName:u.lastName,fieldMode:0}}},{key:"applyNormalizations",value:(a=f(n().m(function e(u,t){var r,a,o,i;return n().w(function(e){for(;;)switch(e.n){case 0:r=0;case 1:if(!(r<t.length)){e.n=3;break}if(!(a=t[r]).accepted){e.n=2;break}return console.log("Applying normalization: ".concat(a.original.firstName," ").concat(a.original.lastName," -> ").concat(a.normalized.firstName," ").concat(a.normalized.lastName)),o=this.buildRawName(a.original),i=this.buildRawName(a.normalized),e.n=2,this.learningEngine.storeMapping(o,i);case 2:r++,e.n=1;break;case 3:console.log("Applied normalizations to item:",u.getField("title"));case 4:return e.a(2)}},e,this)})),function(e,u){return a.apply(this,arguments)})},{key:"performLibraryAnalysis",value:(r=f(n().m(function e(u){var t,r,a,o,i,D,c,l,f,p,y,m,F,h,v,A,C,E,d,g,b,B,w,S;return n().w(function(e){for(;;)if(0===e.n){t=[],r=s(u);try{for(r.s();!(a=r.n()).done;){o=a.value,i=o.getCreators?o.getCreators():[],D=s(i);try{for(D.s();!(c=D.n()).done;)((l=c.value).firstName||l.lastName)&&(f=this.buildRawName(l),t.push(f))}catch(e){D.e(e)}finally{D.f()}}}catch(e){r.e(e)}finally{r.f()}for(this.learningEngine.constructor.prototype.extractSurnamesWithFrequency||this.nameParser.constructor.prototype.extractSurnamesWithFrequency,p={},y=0,m=t;y<m.length;y++)F=m[y],(h=this.nameParser.parse(F)).lastName&&(v=h.lastName.toLowerCase().trim(),p[v]=(p[v]||0)+1);for(A=Object.keys(p),C=[],E=0;E<A.length;E++)for(d=E+1;d<A.length;d++)g=A[E],b=A[d],B=this.calculateLevenshteinDistance(g,b),w=Math.max(g.length,b.length),(S=w>0?1-B/w:1)>=.8&&C.push({name1:g,name2:b,frequency1:p[g],frequency2:p[b],similarity:S});return e.a(2,{surnameFrequencies:p,potentialVariants:C,totalNames:t.length,uniqueSurnames:A.length})}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"calculateLevenshteinDistance",value:function(e,u){var t=[];if(0===e.length)return u.length;if(0===u.length)return e.length;for(var r=0;r<=u.length;r++)t[r]=[r];for(var n=0;n<=e.length;n++)t[0][n]=n;for(var a=1;a<=u.length;a++)for(var o=1;o<=e.length;o++)u.charAt(a-1)===e.charAt(o-1)?t[a][o]=t[a-1][o-1]:t[a][o]=Math.min(t[a-1][o-1]+1,t[a][o-1]+1,t[a-1][o]+1);return t[u.length][e.length]}}],u&&p(e.prototype,u),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,u,r,a,o,D}();e.exports&&(e.exports=m)},95:(e,u,t)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,u){return function(e){if(Array.isArray(e))return e}(e)||function(e,u){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,n,a,o,i=[],D=!0,s=!1;try{if(a=(t=t.call(e)).next,0===u){if(Object(t)!==t)return;D=!1}else for(;!(D=(r=a.call(t)).done)&&(i.push(r.value),i.length!==u);D=!0);}catch(e){s=!0,n=e}finally{try{if(!D&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(s)throw n}}return i}}(e,u)||c(e,u)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,u){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=c(e))||u&&e&&"number"==typeof e.length){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,a=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw a}}}}function o(e,u){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);u&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),t.push.apply(t,r)}return t}function i(e){for(var u=1;u<arguments.length;u++){var t=null!=arguments[u]?arguments[u]:{};u%2?o(Object(t),!0).forEach(function(u){D(e,u,t[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach(function(u){Object.defineProperty(e,u,Object.getOwnPropertyDescriptor(t,u))})}return e}function D(e,u,t){return(u=h(u))in e?Object.defineProperty(e,u,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[u]=t,e}function s(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,u){if(e){if("string"==typeof e)return l(e,u);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?l(e,u):void 0}}function l(e,u){(null==u||u>e.length)&&(u=e.length);for(var t=0,r=Array(u);t<u;t++)r[t]=e[t];return r}function f(){var e,u,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",n=t.toStringTag||"@@toStringTag";function a(t,r,n,a){var D=r&&r.prototype instanceof i?r:i,s=Object.create(D.prototype);return p(s,"_invoke",function(t,r,n){var a,i,D,s=0,c=n||[],l=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(u,t){return a=u,i=0,D=e,f.n=t,o}};function p(t,r){for(i=t,D=r,u=0;!l&&s&&!n&&u<c.length;u++){var n,a=c[u],p=f.p,y=a[2];t>3?(n=y===r)&&(D=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=p&&((n=t<2&&p<a[1])?(i=0,f.v=r,f.n=a[1]):p<y&&(n=t<3||a[0]>r||r>y)&&(a[4]=t,a[5]=r,f.n=y,i=0))}if(n||t>1)return o;throw l=!0,r}return function(n,c,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===c&&p(c,y),i=c,D=y;(u=i<2?e:D)||!l;){a||(i?i<3?(i>1&&(f.n=-1),p(i,D)):f.n=D:f.v=D);try{if(s=2,a){if(i||(n="next"),u=a[n]){if(!(u=u.call(a,D)))throw TypeError("iterator result is not an object");if(!u.done)return u;D=u.value,i<2&&(i=0)}else 1===i&&(u=a.return)&&u.call(a),i<2&&(D=TypeError("The iterator does not provide a '"+n+"' method"),i=1);a=e}else if((u=(l=f.n<0)?D:t.call(r,f))!==o)break}catch(u){a=e,i=1,D=u}finally{s=1}}return{value:u,done:l}}}(t,n,a),!0),s}var o={};function i(){}function D(){}function s(){}u=Object.getPrototypeOf;var c=[][r]?u(u([][r]())):(p(u={},r,function(){return this}),u),l=s.prototype=i.prototype=Object.create(c);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,p(e,n,"GeneratorFunction")),e.prototype=Object.create(l),e}return D.prototype=s,p(l,"constructor",s),p(s,"constructor",D),D.displayName="GeneratorFunction",p(s,n,"GeneratorFunction"),p(l),p(l,n,"Generator"),p(l,r,function(){return this}),p(l,"toString",function(){return"[object Generator]"}),(f=function(){return{w:a,m:y}})()}function p(e,u,t,r){var n=Object.defineProperty;try{n({},"",{})}catch(e){n=0}p=function(e,u,t,r){function a(u,t){p(e,u,function(e){return this._invoke(u,t,e)})}u?n?n(e,u,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[u]=t:(a("next",0),a("throw",1),a("return",2))},p(e,u,t,r)}function y(e,u,t,r,n,a,o){try{var i=e[a](o),D=i.value}catch(e){return void t(e)}i.done?u(D):Promise.resolve(D).then(r,n)}function m(e){return function(){var u=this,t=arguments;return new Promise(function(r,n){var a=e.apply(u,t);function o(e){y(a,r,n,o,i,"next",e)}function i(e){y(a,r,n,o,i,"throw",e)}o(void 0)})}}function F(e,u){for(var t=0;t<u.length;t++){var r=u[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function h(e){var u=function(e){if("object"!=r(e)||!e)return e;var u=e[Symbol.toPrimitive];if(void 0!==u){var t=u.call(e,"string");if("object"!=r(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(u)?u:u+""}var v=function(){return e=function e(){!function(e,u){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this,e),this.storageKey="ner_normalizer_mappings",this.settingsKey="ner_normalizer_settings",this.mappings=new Map,this.settings=this.getDefaultSettings(),this.loadMappings(),this.loadSettings()},u=[{key:"getStorage",value:function(){return"undefined"!=typeof localStorage?localStorage:"undefined"!=typeof window&&window.localStorage?window.localStorage:(t.g._nerStorage||(t.g._nerStorage={}),{getItem:function(e){return t.g._nerStorage[e]||null},setItem:function(e,u){t.g._nerStorage[e]=u},removeItem:function(e){delete t.g._nerStorage[e]}})}},{key:"loadMappings",value:(h=m(f().m(function e(){var u,t,r;return f().w(function(e){for(;;)switch(e.n){case 0:try{u=this.getStorage(),(t=u.getItem(this.storageKey))&&(r=JSON.parse(t),this.mappings=new Map(r))}catch(e){console.error("Error loading mappings:",e),this.mappings=new Map}case 1:return e.a(2)}},e,this)})),function(){return h.apply(this,arguments)})},{key:"saveMappings",value:(y=m(f().m(function e(){var u,t;return f().w(function(e){for(;;)switch(e.n){case 0:try{u=this.getStorage(),t=JSON.stringify(s(this.mappings.entries())),u.setItem(this.storageKey,t)}catch(e){console.error("Error saving mappings:",e)}case 1:return e.a(2)}},e,this)})),function(){return y.apply(this,arguments)})},{key:"loadSettings",value:(p=m(f().m(function e(){var u,t;return f().w(function(e){for(;;)switch(e.n){case 0:try{u=this.getStorage(),(t=u.getItem(this.settingsKey))&&(this.settings=i(i({},this.getDefaultSettings()),JSON.parse(t)))}catch(e){console.error("Error loading settings:",e),this.settings=this.getDefaultSettings()}case 1:return e.a(2)}},e,this)})),function(){return p.apply(this,arguments)})},{key:"saveSettings",value:(l=m(f().m(function e(){return f().w(function(e){for(;;)switch(e.n){case 0:try{this.getStorage().setItem(this.settingsKey,JSON.stringify(this.settings))}catch(e){console.error("Error saving settings:",e)}case 1:return e.a(2)}},e,this)})),function(){return l.apply(this,arguments)})},{key:"getDefaultSettings",value:function(){return{autoApplyLearned:!0,confidenceThreshold:.8,enableSpanishSurnameDetection:!0,showSimilarityScore:!0,maxSuggestions:5}}},{key:"storeMapping",value:(c=m(f().m(function e(u,t){var r,n,a,o,D,s=arguments;return f().w(function(e){for(;;)switch(e.n){case 0:return r=s.length>2&&void 0!==s[2]?s[2]:1,n=s.length>3&&void 0!==s[3]?s[3]:{},a=this.createCanonicalKey(u),o=Date.now(),this.mappings.has(a)?((D=this.mappings.get(a)).normalized=t,D.confidence=Math.max(D.confidence,r),D.lastUsed=o,D.usageCount=(D.usageCount||0)+1,D.context=i(i({},D.context),n)):this.mappings.set(a,{raw:u,normalized:t,timestamp:o,lastUsed:o,confidence:r,usageCount:1,context:n}),e.n=1,this.saveMappings();case 1:return e.a(2)}},e,this)})),function(e,u){return c.apply(this,arguments)})},{key:"recordUsage",value:(D=m(f().m(function e(u){var t,r;return f().w(function(e){for(;;)switch(e.n){case 0:if(t=this.createCanonicalKey(u),!(r=this.mappings.get(t))){e.n=1;break}return r.lastUsed=Date.now(),r.usageCount=(r.usageCount||0)+1,e.n=1,this.saveMappings();case 1:return e.a(2)}},e,this)})),function(e){return D.apply(this,arguments)})},{key:"getMapping",value:function(e){var u=this.createCanonicalKey(e),t=this.mappings.get(u);return t?(this.recordUsage(e),t.normalized):null}},{key:"hasMapping",value:function(e){var u=this.createCanonicalKey(e);return this.mappings.has(u)}},{key:"getMappingDetails",value:function(e){var u=this.createCanonicalKey(e),t=this.mappings.get(u);return t?(this.recordUsage(e),i({},t)):null}},{key:"getAllMappings",value:function(){return new Map(this.mappings)}},{key:"removeMapping",value:(o=m(f().m(function e(u){var t;return f().w(function(e){for(;;)switch(e.n){case 0:return t=this.createCanonicalKey(u),this.mappings.delete(t),e.n=1,this.saveMappings();case 1:return e.a(2)}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"clearAllMappings",value:(r=m(f().m(function e(){return f().w(function(e){for(;;)switch(e.n){case 0:return this.mappings.clear(),e.n=1,this.saveMappings();case 1:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"createCanonicalKey",value:function(e){return e.trim().toLowerCase().replace(/[.,]/g,"").replace(/\s+/g," ")}},{key:"findSimilar",value:function(e){var u,t=this.createCanonicalKey(e),r=[],o=a(this.mappings);try{for(o.s();!(u=o.n()).done;){var D=n(u.value,2),s=D[0],c=D[1],l=this.calculateSimilarity(t,s);l>=this.settings.confidenceThreshold&&r.push(i(i({},c),{},{similarity:l}))}}catch(e){o.e(e)}finally{o.f()}return r.sort(function(e,u){return u.similarity!==e.similarity?u.similarity-e.similarity:(u.usageCount||0)-(e.usageCount||0)}).slice(0,this.settings.maxSuggestions)}},{key:"calculateSimilarity",value:function(e,u){return.5*this.jaroWinklerSimilarity(e,u)+.3*this.lcsSimilarity(e,u)+.2*this.initialMatchingSimilarity(e,u)}},{key:"jaroWinklerSimilarity",value:function(e,u){if(e===u)return 1;if(!e||!u)return 0;for(var t=[],r=e.length,n=u.length,a=Math.floor(Math.max(r,n)/2)-1,o=0,i=0,D=new Array(r).fill(!1),s=new Array(n).fill(!1),c=0;c<r;c++)for(var l=Math.max(0,c-a),f=Math.min(c+a+1,n),p=l;p<f;p++)if(!s[p]&&e[c]===u[p]){D[c]=s[p]=!0,o++,t.push(e[c]);break}if(0===o)return 0;for(var y=0,m=0;m<r;m++)if(D[m]){for(;!s[y];)y++;e[m]!==u[y]&&i++,y++}for(var F=(o/r+o/n+(o-i/2)/o)/3,h=0,v=Math.min(4,Math.min(e.length,u.length)),A=0;A<v&&e[A]===u[A];A++)h++;return F+.1*h*(1-F)}},{key:"lcsSimilarity",value:function(e,u){var t=this;if(!e||!u)return 0;if(e===u)return 1;var r,n=e.split(/\s+/),o=u.split(/\s+/),i=0,D=a(n);try{var s=function(){var e=r.value;o.some(function(u){return t.isSimilarWord(e,u)})&&i++};for(D.s();!(r=D.n()).done;)s()}catch(e){D.e(e)}finally{D.f()}var c=Math.max(n.length,o.length);return c>0?i/c:0}},{key:"isSimilarWord",value:function(e,u){if((e=e.replace(/\./g,""))===(u=u.replace(/\./g,"")))return!0;if(1===e.length&&u.startsWith(e)||1===u.length&&e.startsWith(u))return!0;var t={jose:"joseph",joseph:"joe",robert:"rob",charles:"chuck",william:"will",jonathan:"jon"};return t[e]===u||t[u]===e}},{key:"areWordsSimilar",value:function(e,u){return this.isSimilarWord(e,u)}},{key:"isAbbreviation",value:function(e,u){if(e.length>=u.length)return!1;for(var t=0;t<e.length;t++)if(u[t]!==e[t])return!1;return!0}},{key:"initialMatchingSimilarity",value:function(e,u){var t=e.split(/\s+/),r=u.split(/\s+/);return 0===t.length||0===r.length?0:(this.compareNameParts(t[0],r[0])+this.compareNameParts(t[t.length-1],r[r.length-1]))/2}},{key:"compareNameParts",value:function(e,u){if(!e||!u)return 0;if(e.toLowerCase()===u.toLowerCase())return 1;var t=e.replace(/\./g,"").toLowerCase(),r=u.replace(/\./g,"").toLowerCase();return 1===t.length&&r.startsWith(t)||1===r.length&&t.startsWith(r)?.8:this.jaroWinklerSimilarity(t,r)}},{key:"exportMappings",value:function(){return{version:"1.0",timestamp:Date.now(),mappings:s(this.mappings.entries()),settings:this.settings}}},{key:"importMappings",value:function(e){if("1.0"!==e.version)throw new Error("Unsupported import data version");this.mappings=new Map(e.mappings),e.settings&&(this.settings=i(i({},this.settings),e.settings),this.saveSettings()),this.saveMappings()}},{key:"getStatistics",value:function(){var e,u=this.mappings.size,t=0,r=0,n=a(this.mappings.values());try{for(n.s();!(e=n.n()).done;){var o=e.value;t+=o.usageCount||0,r+=o.confidence||0}}catch(e){n.e(e)}finally{n.f()}return{totalMappings:u,totalUsage:t,averageUsage:u>0?t/u:0,averageConfidence:r=u>0?r/u:0}}}],u&&F(e.prototype,u),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,u,r,o,D,c,l,p,y,h}();e.exports&&(e.exports=v)},208:e=>{function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function t(e,u){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,u){if(e){if("string"==typeof e)return r(e,u);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?r(e,u):void 0}}(e))||u&&e&&"number"==typeof e.length){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,D=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){D=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(D)throw o}}}}function r(e,u){(null==u||u>e.length)&&(u=e.length);for(var t=0,r=Array(u);t<u;t++)r[t]=e[t];return r}function n(){var e,u,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function i(t,r,n,o){var i=r&&r.prototype instanceof s?r:s,c=Object.create(i.prototype);return a(c,"_invoke",function(t,r,n){var a,o,i,s=0,c=n||[],l=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(u,t){return a=u,o=0,i=e,f.n=t,D}};function p(t,r){for(o=t,i=r,u=0;!l&&s&&!n&&u<c.length;u++){var n,a=c[u],p=f.p,y=a[2];t>3?(n=y===r)&&(i=a[(o=a[4])?5:(o=3,3)],a[4]=a[5]=e):a[0]<=p&&((n=t<2&&p<a[1])?(o=0,f.v=r,f.n=a[1]):p<y&&(n=t<3||a[0]>r||r>y)&&(a[4]=t,a[5]=r,f.n=y,o=0))}if(n||t>1)return D;throw l=!0,r}return function(n,c,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===c&&p(c,y),o=c,i=y;(u=o<2?e:i)||!l;){a||(o?o<3?(o>1&&(f.n=-1),p(o,i)):f.n=i:f.v=i);try{if(s=2,a){if(o||(n="next"),u=a[n]){if(!(u=u.call(a,i)))throw TypeError("iterator result is not an object");if(!u.done)return u;i=u.value,o<2&&(o=0)}else 1===o&&(u=a.return)&&u.call(a),o<2&&(i=TypeError("The iterator does not provide a '"+n+"' method"),o=1);a=e}else if((u=(l=f.n<0)?i:t.call(r,f))!==D)break}catch(u){a=e,o=1,i=u}finally{s=1}}return{value:u,done:l}}}(t,n,o),!0),c}var D={};function s(){}function c(){}function l(){}u=Object.getPrototypeOf;var f=[][r]?u(u([][r]())):(a(u={},r,function(){return this}),u),p=l.prototype=s.prototype=Object.create(f);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,a(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return c.prototype=l,a(p,"constructor",l),a(l,"constructor",c),c.displayName="GeneratorFunction",a(l,o,"GeneratorFunction"),a(p),a(p,o,"Generator"),a(p,r,function(){return this}),a(p,"toString",function(){return"[object Generator]"}),(n=function(){return{w:i,m:y}})()}function a(e,u,t,r){var n=Object.defineProperty;try{n({},"",{})}catch(e){n=0}a=function(e,u,t,r){function o(u,t){a(e,u,function(e){return this._invoke(u,t,e)})}u?n?n(e,u,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[u]=t:(o("next",0),o("throw",1),o("return",2))},a(e,u,t,r)}function o(e,u,t,r,n,a,o){try{var i=e[a](o),D=i.value}catch(e){return void t(e)}i.done?u(D):Promise.resolve(D).then(r,n)}function i(e){return function(){var u=this,t=arguments;return new Promise(function(r,n){var a=e.apply(u,t);function i(e){o(a,r,n,i,D,"next",e)}function D(e){o(a,r,n,i,D,"throw",e)}i(void 0)})}}function D(e,u){for(var t=0;t<u.length;t++){var r=u[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}var c=function(){return e=function e(){!function(e,u){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=null,this.isInitialized=!1,this.entities=["person","first_name","middle_name","last_name","prefix","suffix"]},u=[{key:"initialize",value:(o=i(n().m(function e(){var u=this;return n().w(function(e){for(;;)switch(e.n){case 0:console.log("Initializing GLINER model handler...");try{"undefined"!=typeof ort?console.log("ONNX model loaded successfully"):(console.log("ONNX runtime not available, using mock implementation"),this.model={run:function(){var e=i(n().m(function e(t){return n().w(function(e){for(;;)if(0===e.n)return e.a(2,u.mockNERResult(t))},e)}));return function(u){return e.apply(this,arguments)}}()}),this.isInitialized=!0,console.log("GLINER model handler initialized")}catch(e){console.error("Error initializing GLINER model:",e),this.model=null,this.isInitialized=!1}case 1:return e.a(2)}},e,this)})),function(){return o.apply(this,arguments)})},{key:"mockNERResult",value:function(e){for(var u=e.text||e[0]||"",t=u.split(/\s+/),r=[],n=0;n<t.length;n++){var a=t[n],o="O";/^[A-Z]\.?$/.test(a)?o="initial":/^[A-Z][a-z]+/.test(a)&&0===n?o="first_name":/^[A-Z][a-z]+/.test(a)&&n===t.length-1?o="last_name":["van","de","la","von","del","di","du","le","lo"].includes(a.toLowerCase())&&(o="prefix"),r.push({word:a,start:u.indexOf(a),end:u.indexOf(a)+a.length,label:o})}return{entities:r}}},{key:"runNER",value:(a=i(n().m(function e(u){var t,r,a;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.isInitialized){e.n=1;break}return e.n=1,this.initialize();case 1:if(this.model){e.n=2;break}return e.a(2,this.ruleBasedNER(u));case 2:return e.p=2,t={text:u},e.n=3,this.model.run(t);case 3:return r=e.v,e.a(2,r.entities||[]);case 4:return e.p=4,a=e.v,console.error("Error running NER:",a),e.a(2,this.ruleBasedNER(u))}},e,this,[[2,4]])})),function(e){return a.apply(this,arguments)})},{key:"ruleBasedNER",value:function(e){for(var u=e.split(/\s+/),t=[],r=["van","de","la","von","del","di","du","le","lo","da","des","dos","das","el","al"],n=["Jr","Sr","II","III","IV","PhD","MD","Jr.","Sr."],a=function(){var a=u[o].replace(/[.,]/g,""),i=u[o],D="O";n.some(function(e){return e.toLowerCase()===a.toLowerCase()})?D="suffix":r.includes(a.toLowerCase())?D="prefix":/^[A-Z]\.?$/.test(a)?D="initial":0===o?D="first_name":o===u.length-1?D="last_name":o>0&&o<u.length-1&&(D="middle_name"),t.push({text:i,start:e.indexOf(i),end:e.indexOf(i)+i.length,label:D})},o=0;o<u.length;o++)a();return t}},{key:"runBatchNER",value:(r=i(n().m(function e(u){var r,a,o,i,D,s;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:r=[],a=t(u),e.p=1,a.s();case 2:if((o=a.n()).done){e.n=5;break}return i=o.value,e.n=3,this.runNER(i);case 3:D=e.v,r.push({text:i,entities:D});case 4:e.n=2;break;case 5:e.n=7;break;case 6:e.p=6,s=e.v,a.e(s);case 7:return e.p=7,a.f(),e.f(7);case 8:return e.a(2,r)}},e,this,[[1,6,7,8]])})),function(e){return r.apply(this,arguments)})}],u&&D(e.prototype,u),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,u,r,a,o}();e.exports=c},388:(e,u,t)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,u){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,u){if(e){if("string"==typeof e)return a(e,u);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?a(e,u):void 0}}(e))||u&&e&&"number"==typeof e.length){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,D=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){D=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(D)throw o}}}}function a(e,u){(null==u||u>e.length)&&(u=e.length);for(var t=0,r=Array(u);t<u;t++)r[t]=e[t];return r}function o(){var e,u,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",n=t.toStringTag||"@@toStringTag";function a(t,r,n,a){var o=r&&r.prototype instanceof s?r:s,c=Object.create(o.prototype);return i(c,"_invoke",function(t,r,n){var a,o,i,s=0,c=n||[],l=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(u,t){return a=u,o=0,i=e,f.n=t,D}};function p(t,r){for(o=t,i=r,u=0;!l&&s&&!n&&u<c.length;u++){var n,a=c[u],p=f.p,y=a[2];t>3?(n=y===r)&&(i=a[(o=a[4])?5:(o=3,3)],a[4]=a[5]=e):a[0]<=p&&((n=t<2&&p<a[1])?(o=0,f.v=r,f.n=a[1]):p<y&&(n=t<3||a[0]>r||r>y)&&(a[4]=t,a[5]=r,f.n=y,o=0))}if(n||t>1)return D;throw l=!0,r}return function(n,c,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===c&&p(c,y),o=c,i=y;(u=o<2?e:i)||!l;){a||(o?o<3?(o>1&&(f.n=-1),p(o,i)):f.n=i:f.v=i);try{if(s=2,a){if(o||(n="next"),u=a[n]){if(!(u=u.call(a,i)))throw TypeError("iterator result is not an object");if(!u.done)return u;i=u.value,o<2&&(o=0)}else 1===o&&(u=a.return)&&u.call(a),o<2&&(i=TypeError("The iterator does not provide a '"+n+"' method"),o=1);a=e}else if((u=(l=f.n<0)?i:t.call(r,f))!==D)break}catch(u){a=e,o=1,i=u}finally{s=1}}return{value:u,done:l}}}(t,n,a),!0),c}var D={};function s(){}function c(){}function l(){}u=Object.getPrototypeOf;var f=[][r]?u(u([][r]())):(i(u={},r,function(){return this}),u),p=l.prototype=s.prototype=Object.create(f);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,i(e,n,"GeneratorFunction")),e.prototype=Object.create(p),e}return c.prototype=l,i(p,"constructor",l),i(l,"constructor",c),c.displayName="GeneratorFunction",i(l,n,"GeneratorFunction"),i(p),i(p,n,"Generator"),i(p,r,function(){return this}),i(p,"toString",function(){return"[object Generator]"}),(o=function(){return{w:a,m:y}})()}function i(e,u,t,r){var n=Object.defineProperty;try{n({},"",{})}catch(e){n=0}i=function(e,u,t,r){function a(u,t){i(e,u,function(e){return this._invoke(u,t,e)})}u?n?n(e,u,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[u]=t:(a("next",0),a("throw",1),a("return",2))},i(e,u,t,r)}function D(e,u,t,r,n,a,o){try{var i=e[a](o),D=i.value}catch(e){return void t(e)}i.done?u(D):Promise.resolve(D).then(r,n)}function s(e){return function(){var u=this,t=arguments;return new Promise(function(r,n){var a=e.apply(u,t);function o(e){D(a,r,n,o,i,"next",e)}function i(e){D(a,r,n,o,i,"throw",e)}o(void 0)})}}function c(e,u){for(var t=0;t<u.length;t++){var r=u[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var u=function(e){if("object"!=r(e)||!e)return e;var u=e[Symbol.toPrimitive];if(void 0!==u){var t=u.call(e,"string");if("object"!=r(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(u)?u:u+""}var f=function(){return e=function e(){!function(e,u){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this,e),this.glinerHandler=null,this.isInitialized=!1,this.entities=["PERSON","FIRST_NAME","MIDDLE_NAME","LAST_NAME","PREFIX","SUFFIX"]},u=[{key:"initialize",value:(D=s(o().m(function e(){var u,r;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return u=t(208),this.glinerHandler=new u,e.p=1,e.n=2,this.glinerHandler.initialize();case 2:console.log("NER Processor initialized with GLINER handler"),e.n=4;break;case 3:e.p=3,r=e.v,console.error("Error initializing GLINER handler:",r),console.log("Using fallback rule-based processing");case 4:this.isInitialized=!0;case 5:return e.a(2)}},e,this,[[1,3]])})),function(){return D.apply(this,arguments)})},{key:"processText",value:(i=s(o().m(function e(u){return o().w(function(e){for(;;)switch(e.n){case 0:if(this.isInitialized){e.n=1;break}return e.n=1,this.initialize();case 1:if(!this.glinerHandler||!this.glinerHandler.isInitialized){e.n=3;break}return e.n=2,this.glinerHandler.runNER(u);case 2:return e.a(2,e.v);case 3:return e.a(2,this.fallbackNER(u));case 4:return e.a(2)}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"fallbackNER",value:function(e){for(var u=e.split(/\s+/),t=[],r=["van","de","la","von","del","di","du","le","lo","da","des","dos","das","el","al"],n=["Jr","Sr","II","III","IV","PhD","MD","Jr.","Sr."],a=function(){var a=u[o].replace(/[.,]/g,""),i=u[o],D="O";n.some(function(e){return e.toLowerCase()===a.toLowerCase()})?D="suffix":r.includes(a.toLowerCase())?D="prefix":/^[A-Z]\.?$/.test(a)?D="initial":0===o?D="first_name":o===u.length-1?D="last_name":o>0&&o<u.length-1&&(D="middle_name"),t.push({text:i,start:e.indexOf(i),end:e.indexOf(i)+i.length,label:D})},o=0;o<u.length;o++)a();return t}},{key:"parseName",value:(a=s(o().m(function e(u){var t;return o().w(function(e){for(;;)switch(e.n){case 0:if(this.isInitialized){e.n=1;break}return e.n=1,this.initialize();case 1:return e.n=2,this.processText(u);case 2:return t=e.v,e.a(2,this.structureNameComponents(u,t))}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"structureNameComponents",value:function(e,u){var r,a=(new(t(889))).parse(e),o=n(u);try{for(o.s();!(r=o.n()).done;){var i=r.value;"prefix"===i.label?a.prefix=i.text:"suffix"===i.label&&(a.suffix=i.text)}}catch(e){o.e(e)}finally{o.f()}return a}},{key:"processBatch",value:(r=s(o().m(function e(u){var t,r,a,i,D,s;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.isInitialized){e.n=1;break}return e.n=1,this.initialize();case 1:if(!this.glinerHandler||!this.glinerHandler.isInitialized){e.n=3;break}return e.n=2,this.glinerHandler.runBatchNER(u);case 2:return e.a(2,e.v);case 3:t=[],r=n(u),e.p=4,r.s();case 5:if((a=r.n()).done){e.n=8;break}return i=a.value,e.n=6,this.fallbackNER(i);case 6:D=e.v,t.push({text:i,entities:D});case 7:e.n=5;break;case 8:e.n=10;break;case 9:e.p=9,s=e.v,r.e(s);case 10:return e.p=10,r.f(),e.f(10);case 11:return e.a(2,t);case 12:return e.a(2)}},e,this,[[4,9,10,11]])})),function(e){return r.apply(this,arguments)})},{key:"getConfidence",value:function(e){var u=.5;return e.firstName&&e.lastName&&(u+=.3),e.prefix&&(u+=.1),e.suffix&&(u+=.1),e.firstName&&e.firstName.length>2&&(u+=.05),e.lastName&&e.lastName.length>2&&(u+=.05),Math.min(u,1)}},{key:"findVariantsBySimilarity",value:function(e,u){var t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8,a=[],o=n(u);try{for(o.s();!(t=o.n()).done;){var i=t.value,D=this.levenshteinDistance(e,i),s=1-D/Math.max(e.length,i.length);s>=r&&a.push({name:i,similarity:s,distance:D})}}catch(e){o.e(e)}finally{o.f()}return a.sort(function(e,u){return u.similarity-e.similarity})}},{key:"levenshteinDistance",value:function(e,u){var t=[];if(0===e.length)return u.length;if(0===u.length)return e.length;for(var r=0;r<=u.length;r++)t[r]=[r];for(var n=0;n<=e.length;n++)t[0][n]=n;for(var a=1;a<=u.length;a++)for(var o=1;o<=e.length;o++)u.charAt(a-1)===e.charAt(o-1)?t[a][o]=t[a-1][o-1]:t[a][o]=Math.min(t[a-1][o-1]+1,t[a][o-1]+1,t[a-1][o]+1);return t[u.length][e.length]}},{key:"extractNameFrequencies",value:function(e){var u,r={},a={},o=new(t(889)),i=n(e);try{for(i.s();!(u=i.n()).done;){var D=u.value,s=o.parse(D);if(s.lastName){var c=s.lastName.toLowerCase().trim();r[c]=(r[c]||0)+1}if(s.firstName){var l=s.firstName.toLowerCase().trim();a[l]=(a[l]||0)+1}}}catch(e){i.e(e)}finally{i.f()}return{surnames:r,firstNames:a}}}],u&&c(e.prototype,u),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,u,r,a,i,D}();e.exports&&(e.exports=f)},441:e=>{function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function t(e,u){for(var t=0;t<u.length;t++){var n=u[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r(n.key),n)}}function r(e){var t=function(e){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}var n=function(){return e=function e(){!function(e,u){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this,e),this.variationPatterns=[this.fullForm,this.initialForm,this.lastOnlyForm,this.firstInitialLastForm,this.firstInitialsLastForm]},(u=[{key:"generateVariants",value:function(e){var u=this,t=new Set;return this.variationPatterns.forEach(function(r){var n=r.call(u,e);n&&t.add(n)}),t.add(e.original),Array.from(t)}},{key:"fullForm",value:function(e){var u=[];return e.firstName&&u.push(e.firstName),e.middleName&&u.push(e.middleName),e.prefix&&u.push(e.prefix),e.lastName&&u.push(e.lastName),u.join(" ").trim()}},{key:"initialForm",value:function(e){if(!e.firstName||!e.lastName)return null;var u=e.firstName.charAt(0).toUpperCase()+".",t="";e.middleName&&(t=e.middleName.split(/\s+/).map(function(e){return e.charAt(0).toUpperCase()+"."}).join(" "));var r=[];return r.push(u),t&&r.push(t),e.prefix&&r.push(e.prefix),r.push(e.lastName),r.join(" ").trim()}},{key:"lastOnlyForm",value:function(e){return e.lastName?e.lastName.trim():null}},{key:"firstInitialLastForm",value:function(e){if(!e.firstName||!e.lastName)return null;var u=e.firstName.charAt(0).toUpperCase()+".",t=[];return t.push(u),e.prefix&&t.push(e.prefix),t.push(e.lastName),t.join(" ").trim()}},{key:"firstInitialsLastForm",value:function(e){if(!e.firstName||!e.lastName)return null;var u=e.firstName.charAt(0).toUpperCase()+".",t="";e.middleName&&(t=e.middleName.split(/\s+/).map(function(e){return e.charAt(0).toUpperCase()+"."}).join(""));var r=[];return r.push(u+t),e.prefix&&r.push(e.prefix),r.push(e.lastName),r.join(" ").trim().replace(/\.{2,}/g,".")}},{key:"generateCanonical",value:function(e){var u=[];return e.lastName&&u.push(e.lastName.toUpperCase()),e.firstName&&u.push(e.firstName.toUpperCase()),e.middleName&&e.middleName.split(/\s+/).forEach(function(e){return u.push(e.toUpperCase())}),u.join(" ").trim()}}])&&t(e.prototype,u),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,u}();e.exports&&(e.exports=n)},491:(e,u,t)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,u){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);u&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),t.push.apply(t,r)}return t}function a(e){for(var u=1;u<arguments.length;u++){var t=null!=arguments[u]?arguments[u]:{};u%2?n(Object(t),!0).forEach(function(u){o(e,u,t[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach(function(u){Object.defineProperty(e,u,Object.getOwnPropertyDescriptor(t,u))})}return e}function o(e,u,t){return(u=y(u))in e?Object.defineProperty(e,u,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[u]=t,e}function i(){var e,u,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",n=t.toStringTag||"@@toStringTag";function a(t,r,n,a){var i=r&&r.prototype instanceof s?r:s,c=Object.create(i.prototype);return D(c,"_invoke",function(t,r,n){var a,i,D,s=0,c=n||[],l=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(u,t){return a=u,i=0,D=e,f.n=t,o}};function p(t,r){for(i=t,D=r,u=0;!l&&s&&!n&&u<c.length;u++){var n,a=c[u],p=f.p,y=a[2];t>3?(n=y===r)&&(D=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=p&&((n=t<2&&p<a[1])?(i=0,f.v=r,f.n=a[1]):p<y&&(n=t<3||a[0]>r||r>y)&&(a[4]=t,a[5]=r,f.n=y,i=0))}if(n||t>1)return o;throw l=!0,r}return function(n,c,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===c&&p(c,y),i=c,D=y;(u=i<2?e:D)||!l;){a||(i?i<3?(i>1&&(f.n=-1),p(i,D)):f.n=D:f.v=D);try{if(s=2,a){if(i||(n="next"),u=a[n]){if(!(u=u.call(a,D)))throw TypeError("iterator result is not an object");if(!u.done)return u;D=u.value,i<2&&(i=0)}else 1===i&&(u=a.return)&&u.call(a),i<2&&(D=TypeError("The iterator does not provide a '"+n+"' method"),i=1);a=e}else if((u=(l=f.n<0)?D:t.call(r,f))!==o)break}catch(u){a=e,i=1,D=u}finally{s=1}}return{value:u,done:l}}}(t,n,a),!0),c}var o={};function s(){}function c(){}function l(){}u=Object.getPrototypeOf;var f=[][r]?u(u([][r]())):(D(u={},r,function(){return this}),u),p=l.prototype=s.prototype=Object.create(f);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,D(e,n,"GeneratorFunction")),e.prototype=Object.create(p),e}return c.prototype=l,D(p,"constructor",l),D(l,"constructor",c),c.displayName="GeneratorFunction",D(l,n,"GeneratorFunction"),D(p),D(p,n,"Generator"),D(p,r,function(){return this}),D(p,"toString",function(){return"[object Generator]"}),(i=function(){return{w:a,m:y}})()}function D(e,u,t,r){var n=Object.defineProperty;try{n({},"",{})}catch(e){n=0}D=function(e,u,t,r){function a(u,t){D(e,u,function(e){return this._invoke(u,t,e)})}u?n?n(e,u,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[u]=t:(a("next",0),a("throw",1),a("return",2))},D(e,u,t,r)}function s(e,u){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,u){if(e){if("string"==typeof e)return c(e,u);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(e,u):void 0}}(e))||u&&e&&"number"==typeof e.length){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,a=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw a}}}}function c(e,u){(null==u||u>e.length)&&(u=e.length);for(var t=0,r=Array(u);t<u;t++)r[t]=e[t];return r}function l(e,u,t,r,n,a,o){try{var i=e[a](o),D=i.value}catch(e){return void t(e)}i.done?u(D):Promise.resolve(D).then(r,n)}function f(e){return function(){var u=this,t=arguments;return new Promise(function(r,n){var a=e.apply(u,t);function o(e){l(a,r,n,o,i,"next",e)}function i(e){l(a,r,n,o,i,"throw",e)}o(void 0)})}}function p(e,u){for(var t=0;t<u.length;t++){var r=u[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y(r.key),r)}}function y(e){var u=function(e){if("object"!=r(e)||!e)return e;var u=e[Symbol.toPrimitive];if(void 0!==u){var t=u.call(e,"string");if("object"!=r(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(u)?u:u+""}var m=function(){return e=function e(){!function(e,u){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this,e),this.learningEngine=new(t(95)),this.variantGenerator=new(t(441)),this.nameParser=new(t(889))},u=[{key:"showDialog",value:(o=f(i().m(function e(u){var t,r,n,a,o,D;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:console.log("Showing normalization dialog for",u.length,"items"),t=[],r=s(u),e.p=1,r.s();case 2:if((n=r.n()).done){e.n=5;break}return a=n.value,e.n=3,this.processItem(a);case 3:o=e.v,t.push(o);case 4:e.n=2;break;case 5:e.n=7;break;case 6:e.p=6,D=e.v,r.e(D);case 7:return e.p=7,r.f(),e.f(7);case 8:return e.n=9,this.presentOptions(t);case 9:return e.a(2,e.v)}},e,this,[[1,6,7,8]])})),function(e){return o.apply(this,arguments)})},{key:"processItem",value:(n=f(i().m(function e(u){var t,r,n,o,D,c,l,f,p,y,m;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:t=u.getCreators?u.getCreators():[],r=[],n=s(t),e.p=1,n.s();case 2:if((o=n.n()).done){e.n=5;break}if(!(D=o.value).firstName&&!D.lastName){e.n=4;break}if(c=this.buildRawName(D),!(l=this.learningEngine.getMapping(c))){e.n=3;break}return r.push({original:a({},D),normalized:l,type:D.creatorType,alreadyLearned:!0,status:"learned"}),e.a(3,4);case 3:f=this.learningEngine.findSimilar(c),p=this.nameParser.parse(c),y=this.variantGenerator.generateVariants(p),r.push({original:a({},D),rawName:c,variants:y,similars:f,type:D.creatorType,alreadyLearned:!1,parsed:p,status:"new"});case 4:e.n=2;break;case 5:e.n=7;break;case 6:e.p=6,m=e.v,n.e(m);case 7:return e.p=7,n.f(),e.f(7);case 8:return e.a(2,{itemID:u.id,title:u.getField?u.getField("title"):"Unknown Title",creators:r})}},e,this,[[1,6,7,8]])})),function(e){return n.apply(this,arguments)})},{key:"buildRawName",value:function(e){return"".concat(e.firstName||""," ").concat(e.lastName||"").trim()}},{key:"presentOptions",value:(r=f(i().m(function e(u){var t,r,n,a,o,D,c,l,f;return i().w(function(e){for(;;)if(0===e.n){console.log("Presenting options to user:"),t=[],r=s(u);try{for(r.s();!(n=r.n()).done;){a=n.value,o={itemID:a.itemID,title:a.title,creators:[]},D=s(a.creators);try{for(D.s();!(c=D.n()).done;)(l=c.value).alreadyLearned?o.creators.push({original:l.original,normalized:l.normalized,type:l.type,accepted:!0,source:"learned"}):(f=l.variants[0],o.creators.push({original:l.original,normalized:f,type:l.type,accepted:!0,source:"user_selected",selectedFrom:"variants"}))}catch(e){D.e(e)}finally{D.f()}t.push(o)}}catch(e){r.e(e)}finally{r.f()}return e.a(2,t)}},e)})),function(e){return r.apply(this,arguments)})},{key:"renderUIDemo",value:function(e){var u,t='<div class="ner-normalizer-dialog"><h2>Author Name Normalization</h2>',r=s(e);try{for(r.s();!(u=r.n()).done;){var n=u.value;t+='<div class="item-section" data-item-id="'.concat(n.itemID,'">'),t+="<h3>".concat(n.title,"</h3>");var a,o=s(n.creators);try{for(o.s();!(a=o.n()).done;){var i=a.value;if(t+='<div class="creator-section">',i.alreadyLearned)t+="<p><strong>Learned:</strong> ".concat(i.rawName,"  ").concat(i.normalized,"</p>");else{t+="<p><strong>Original:</strong> ".concat(i.rawName,"</p>"),t+='<div class="variants-section">',t+="<h4>Variant Suggestions:</h4><ul>";var D,c=s(i.variants);try{for(c.s();!(D=c.n()).done;){var l=D.value;t+='<li><label><input type="radio" name="selection-'.concat(i.rawName,'" value="').concat(l,'"> ').concat(l,"</label></li>")}}catch(e){c.e(e)}finally{c.f()}if(t+="</ul></div>",i.similars.length>0){t+='<div class="similar-section">',t+="<h4>Similar Previously Learned Names:</h4><ul>";var f,p=s(i.similars);try{for(p.s();!(f=p.n()).done;){var y=f.value;t+='<li><label><input type="radio" name="selection-'.concat(i.rawName,'" value="').concat(y.normalized,'"> ').concat(y.raw,"  ").concat(y.normalized," (confidence: ").concat((100*y.similarity).toFixed(1),"%)</label></li>")}}catch(e){p.e(e)}finally{p.f()}t+="</ul></div>"}}t+="</div>"}}catch(e){o.e(e)}finally{o.f()}t+="</div>"}}catch(e){r.e(e)}finally{r.f()}return t+='<div class="dialog-actions">',t+='<button id="accept-all-btn">Accept All</button>',(t+='<button id="cancel-btn">Cancel</button>')+"</div></div>"}}],u&&p(e.prototype,u),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,u,r,n,o}();e.exports&&(e.exports=m)},588:e=>{function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function t(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,u){if(e){if("string"==typeof e)return r(e,u);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?r(e,u):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,u){(null==u||u>e.length)&&(u=e.length);for(var t=0,r=Array(u);t<u;t++)r[t]=e[t];return r}function n(){var e,u,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function i(t,r,n,o){var i=r&&r.prototype instanceof s?r:s,c=Object.create(i.prototype);return a(c,"_invoke",function(t,r,n){var a,o,i,s=0,c=n||[],l=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(u,t){return a=u,o=0,i=e,f.n=t,D}};function p(t,r){for(o=t,i=r,u=0;!l&&s&&!n&&u<c.length;u++){var n,a=c[u],p=f.p,y=a[2];t>3?(n=y===r)&&(i=a[(o=a[4])?5:(o=3,3)],a[4]=a[5]=e):a[0]<=p&&((n=t<2&&p<a[1])?(o=0,f.v=r,f.n=a[1]):p<y&&(n=t<3||a[0]>r||r>y)&&(a[4]=t,a[5]=r,f.n=y,o=0))}if(n||t>1)return D;throw l=!0,r}return function(n,c,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===c&&p(c,y),o=c,i=y;(u=o<2?e:i)||!l;){a||(o?o<3?(o>1&&(f.n=-1),p(o,i)):f.n=i:f.v=i);try{if(s=2,a){if(o||(n="next"),u=a[n]){if(!(u=u.call(a,i)))throw TypeError("iterator result is not an object");if(!u.done)return u;i=u.value,o<2&&(o=0)}else 1===o&&(u=a.return)&&u.call(a),o<2&&(i=TypeError("The iterator does not provide a '"+n+"' method"),o=1);a=e}else if((u=(l=f.n<0)?i:t.call(r,f))!==D)break}catch(u){a=e,o=1,i=u}finally{s=1}}return{value:u,done:l}}}(t,n,o),!0),c}var D={};function s(){}function c(){}function l(){}u=Object.getPrototypeOf;var f=[][r]?u(u([][r]())):(a(u={},r,function(){return this}),u),p=l.prototype=s.prototype=Object.create(f);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,a(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return c.prototype=l,a(p,"constructor",l),a(l,"constructor",c),c.displayName="GeneratorFunction",a(l,o,"GeneratorFunction"),a(p),a(p,o,"Generator"),a(p,r,function(){return this}),a(p,"toString",function(){return"[object Generator]"}),(n=function(){return{w:i,m:y}})()}function a(e,u,t,r){var n=Object.defineProperty;try{n({},"",{})}catch(e){n=0}a=function(e,u,t,r){function o(u,t){a(e,u,function(e){return this._invoke(u,t,e)})}u?n?n(e,u,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[u]=t:(o("next",0),o("throw",1),o("return",2))},a(e,u,t,r)}function o(e,u,t,r,n,a,o){try{var i=e[a](o),D=i.value}catch(e){return void t(e)}i.done?u(D):Promise.resolve(D).then(r,n)}function i(e){return function(){var u=this,t=arguments;return new Promise(function(r,n){var a=e.apply(u,t);function i(e){o(a,r,n,i,D,"next",e)}function D(e){o(a,r,n,i,D,"throw",e)}i(void 0)})}}function D(e,u){for(var t=0;t<u.length;t++){var r=u[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}var c=function(){return e=function e(){!function(e,u){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this,e),this.settingsKey="ner_normalizer_settings",this.mappingsKey="ner_normalizer_mappings"},u=[{key:"saveSettings",value:(c=i(n().m(function e(u){var t,r;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,t=JSON.stringify(u),localStorage.setItem(this.settingsKey,t),e.a(2,!0);case 1:return e.p=1,r=e.v,console.error("Error saving settings:",r),e.a(2,!1)}},e,this,[[0,1]])})),function(e){return c.apply(this,arguments)})},{key:"loadSettings",value:(s=i(n().m(function e(){var u,t;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!(u=localStorage.getItem(this.settingsKey))){e.n=1;break}return e.a(2,JSON.parse(u));case 1:return e.a(2,this.getDefaultSettings());case 2:return e.p=2,t=e.v,console.error("Error loading settings:",t),e.a(2,this.getDefaultSettings())}},e,this,[[0,2]])})),function(){return s.apply(this,arguments)})},{key:"getDefaultSettings",value:function(){return{autoApplyLearned:!0,showSuggestionsThreshold:.8,enableSpanishSurnameDetection:!0}}},{key:"saveMappings",value:(o=i(n().m(function e(u){var r,a;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,r=JSON.stringify(t(u.entries())),localStorage.setItem(this.mappingsKey,r),e.a(2,!0);case 1:return e.p=1,a=e.v,console.error("Error saving mappings:",a),e.a(2,!1)}},e,this,[[0,1]])})),function(e){return o.apply(this,arguments)})},{key:"loadMappings",value:(a=i(n().m(function e(){var u,t;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!(u=localStorage.getItem(this.mappingsKey))){e.n=1;break}return e.a(2,new Map(JSON.parse(u)));case 1:return e.a(2,new Map);case 2:return e.p=2,t=e.v,console.error("Error loading mappings:",t),e.a(2,new Map)}},e,this,[[0,2]])})),function(){return a.apply(this,arguments)})},{key:"clearAllData",value:(r=i(n().m(function e(){return n().w(function(e){for(;;)switch(e.n){case 0:localStorage.removeItem(this.settingsKey),localStorage.removeItem(this.mappingsKey);case 1:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})}],u&&D(e.prototype,u),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,u,r,a,o,s,c}();e.exports&&(e.exports=c)},672:(e,u,t)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(){var e,u,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function i(t,r,n,o){var i=r&&r.prototype instanceof s?r:s,c=Object.create(i.prototype);return a(c,"_invoke",function(t,r,n){var a,o,i,s=0,c=n||[],l=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(u,t){return a=u,o=0,i=e,f.n=t,D}};function p(t,r){for(o=t,i=r,u=0;!l&&s&&!n&&u<c.length;u++){var n,a=c[u],p=f.p,y=a[2];t>3?(n=y===r)&&(i=a[(o=a[4])?5:(o=3,3)],a[4]=a[5]=e):a[0]<=p&&((n=t<2&&p<a[1])?(o=0,f.v=r,f.n=a[1]):p<y&&(n=t<3||a[0]>r||r>y)&&(a[4]=t,a[5]=r,f.n=y,o=0))}if(n||t>1)return D;throw l=!0,r}return function(n,c,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===c&&p(c,y),o=c,i=y;(u=o<2?e:i)||!l;){a||(o?o<3?(o>1&&(f.n=-1),p(o,i)):f.n=i:f.v=i);try{if(s=2,a){if(o||(n="next"),u=a[n]){if(!(u=u.call(a,i)))throw TypeError("iterator result is not an object");if(!u.done)return u;i=u.value,o<2&&(o=0)}else 1===o&&(u=a.return)&&u.call(a),o<2&&(i=TypeError("The iterator does not provide a '"+n+"' method"),o=1);a=e}else if((u=(l=f.n<0)?i:t.call(r,f))!==D)break}catch(u){a=e,o=1,i=u}finally{s=1}}return{value:u,done:l}}}(t,n,o),!0),c}var D={};function s(){}function c(){}function l(){}u=Object.getPrototypeOf;var f=[][r]?u(u([][r]())):(a(u={},r,function(){return this}),u),p=l.prototype=s.prototype=Object.create(f);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,a(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return c.prototype=l,a(p,"constructor",l),a(l,"constructor",c),c.displayName="GeneratorFunction",a(l,o,"GeneratorFunction"),a(p),a(p,o,"Generator"),a(p,r,function(){return this}),a(p,"toString",function(){return"[object Generator]"}),(n=function(){return{w:i,m:y}})()}function a(e,u,t,r){var n=Object.defineProperty;try{n({},"",{})}catch(e){n=0}a=function(e,u,t,r){function o(u,t){a(e,u,function(e){return this._invoke(u,t,e)})}u?n?n(e,u,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[u]=t:(o("next",0),o("throw",1),o("return",2))},a(e,u,t,r)}function o(e,u){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,u){if(e){if("string"==typeof e)return i(e,u);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(e,u):void 0}}(e))||u&&e&&"number"==typeof e.length){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,D=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return o=e.done,e},e:function(e){D=!0,a=e},f:function(){try{o||null==t.return||t.return()}finally{if(D)throw a}}}}function i(e,u){(null==u||u>e.length)&&(u=e.length);for(var t=0,r=Array(u);t<u;t++)r[t]=e[t];return r}function D(e,u,t,r,n,a,o){try{var i=e[a](o),D=i.value}catch(e){return void t(e)}i.done?u(D):Promise.resolve(D).then(r,n)}function s(e){return function(){var u=this,t=arguments;return new Promise(function(r,n){var a=e.apply(u,t);function o(e){D(a,r,n,o,i,"next",e)}function i(e){D(a,r,n,o,i,"throw",e)}o(void 0)})}}function c(e,u){for(var t=0;t<u.length;t++){var r=u[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var u=function(e){if("object"!=r(e)||!e)return e;var u=e[Symbol.toPrimitive];if(void 0!==u){var t=u.call(e,"string");if("object"!=r(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(u)?u:u+""}var f=function(){return e=function e(){!function(e,u){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this,e),this.learningEngine=new(t(95))},u=[{key:"processBatch",value:(a=s(n().m(function e(u){var t,r,a,i;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:console.log("Processing ".concat(u.length," items in batch")),t=o(u),e.p=1,t.s();case 2:if((r=t.n()).done){e.n=4;break}return a=r.value,e.n=3,this.processItem(a);case 3:e.n=2;break;case 4:e.n=6;break;case 5:e.p=5,i=e.v,t.e(i);case 6:return e.p=6,t.f(),e.f(6);case 7:return e.a(2,{success:!0,processedCount:u.length})}},e,this,[[1,5,6,7]])})),function(e){return a.apply(this,arguments)})},{key:"processItem",value:(r=s(n().m(function e(u){var t,r,a,i,D,s;return n().w(function(e){for(;;)switch(e.n){case 0:t=u.getCreators?u.getCreators():[],r=o(t);try{for(r.s();!(a=r.n()).done;)((i=a.value).firstName||i.lastName)&&(D="".concat(i.firstName||""," ").concat(i.lastName||"").trim(),(s=this.learningEngine.getMapping(D))?console.log("Applying learned normalization: ".concat(D," -> ").concat(s)):console.log("Need to process: ".concat(D)))}catch(e){r.e(e)}finally{r.f()}case 1:return e.a(2)}},e,this)})),function(e){return r.apply(this,arguments)})}],u&&c(e.prototype,u),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,u,r,a}();e.exports&&(e.exports=f)},827:(e,u,t)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,u){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,u){if(e){if("string"==typeof e)return a(e,u);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?a(e,u):void 0}}(e))||u&&e&&"number"==typeof e.length){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,D=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){D=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(D)throw o}}}}function a(e,u){(null==u||u>e.length)&&(u=e.length);for(var t=0,r=Array(u);t<u;t++)r[t]=e[t];return r}function o(){var e,u,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",n=t.toStringTag||"@@toStringTag";function a(t,r,n,a){var o=r&&r.prototype instanceof s?r:s,c=Object.create(o.prototype);return i(c,"_invoke",function(t,r,n){var a,o,i,s=0,c=n||[],l=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(u,t){return a=u,o=0,i=e,f.n=t,D}};function p(t,r){for(o=t,i=r,u=0;!l&&s&&!n&&u<c.length;u++){var n,a=c[u],p=f.p,y=a[2];t>3?(n=y===r)&&(i=a[(o=a[4])?5:(o=3,3)],a[4]=a[5]=e):a[0]<=p&&((n=t<2&&p<a[1])?(o=0,f.v=r,f.n=a[1]):p<y&&(n=t<3||a[0]>r||r>y)&&(a[4]=t,a[5]=r,f.n=y,o=0))}if(n||t>1)return D;throw l=!0,r}return function(n,c,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===c&&p(c,y),o=c,i=y;(u=o<2?e:i)||!l;){a||(o?o<3?(o>1&&(f.n=-1),p(o,i)):f.n=i:f.v=i);try{if(s=2,a){if(o||(n="next"),u=a[n]){if(!(u=u.call(a,i)))throw TypeError("iterator result is not an object");if(!u.done)return u;i=u.value,o<2&&(o=0)}else 1===o&&(u=a.return)&&u.call(a),o<2&&(i=TypeError("The iterator does not provide a '"+n+"' method"),o=1);a=e}else if((u=(l=f.n<0)?i:t.call(r,f))!==D)break}catch(u){a=e,o=1,i=u}finally{s=1}}return{value:u,done:l}}}(t,n,a),!0),c}var D={};function s(){}function c(){}function l(){}u=Object.getPrototypeOf;var f=[][r]?u(u([][r]())):(i(u={},r,function(){return this}),u),p=l.prototype=s.prototype=Object.create(f);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,i(e,n,"GeneratorFunction")),e.prototype=Object.create(p),e}return c.prototype=l,i(p,"constructor",l),i(l,"constructor",c),c.displayName="GeneratorFunction",i(l,n,"GeneratorFunction"),i(p),i(p,n,"Generator"),i(p,r,function(){return this}),i(p,"toString",function(){return"[object Generator]"}),(o=function(){return{w:a,m:y}})()}function i(e,u,t,r){var n=Object.defineProperty;try{n({},"",{})}catch(e){n=0}i=function(e,u,t,r){function a(u,t){i(e,u,function(e){return this._invoke(u,t,e)})}u?n?n(e,u,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[u]=t:(a("next",0),a("throw",1),a("return",2))},i(e,u,t,r)}function D(e,u,t,r,n,a,o){try{var i=e[a](o),D=i.value}catch(e){return void t(e)}i.done?u(D):Promise.resolve(D).then(r,n)}function s(e){return function(){var u=this,t=arguments;return new Promise(function(r,n){var a=e.apply(u,t);function o(e){D(a,r,n,o,i,"next",e)}function i(e){D(a,r,n,o,i,"throw",e)}o(void 0)})}}function c(e,u){for(var t=0;t<u.length;t++){var r=u[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var u=function(e){if("object"!=r(e)||!e)return e;var u=e[Symbol.toPrimitive];if(void 0!==u){var t=u.call(e,"string");if("object"!=r(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(u)?u:u+""}var f=function(){return e=function e(){!function(e,u){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this,e),this.isInitialized=!1,this.model=null},u=[{key:"initialize",value:(i=s(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:console.log("NER Worker initialized"),this.isInitialized=!0;case 1:return e.a(2)}},e,this)})),function(){return i.apply(this,arguments)})},{key:"processNames",value:(a=s(o().m(function e(u){var t,r,a,i,D,s;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.isInitialized){e.n=1;break}return e.n=1,this.initialize();case 1:t=[],r=n(u),e.p=2,r.s();case 3:if((a=r.n()).done){e.n=6;break}return i=a.value,e.n=4,this.processSingleName(i);case 4:D=e.v,t.push(D);case 5:e.n=3;break;case 6:e.n=8;break;case 7:e.p=7,s=e.v,r.e(s);case 8:return e.p=8,r.f(),e.f(8);case 9:return e.a(2,t)}},e,this,[[2,7,8,9]])})),function(e){return a.apply(this,arguments)})},{key:"processSingleName",value:(r=s(o().m(function e(u){var r,n;return o().w(function(e){for(;;)if(0===e.n)return r=t(889),n=new r,e.a(2,n.parse(u))},e)})),function(e){return r.apply(this,arguments)})}],u&&c(e.prototype,u),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,u,r,a,i}();e.exports&&(e.exports=f)},886:(e,u,t)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,u){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,u){if(e){if("string"==typeof e)return a(e,u);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?a(e,u):void 0}}(e))||u&&e&&"number"==typeof e.length){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,D=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){D=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(D)throw o}}}}function a(e,u){(null==u||u>e.length)&&(u=e.length);for(var t=0,r=Array(u);t<u;t++)r[t]=e[t];return r}function o(){var e,u,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",n=t.toStringTag||"@@toStringTag";function a(t,r,n,a){var o=r&&r.prototype instanceof s?r:s,c=Object.create(o.prototype);return i(c,"_invoke",function(t,r,n){var a,o,i,s=0,c=n||[],l=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(u,t){return a=u,o=0,i=e,f.n=t,D}};function p(t,r){for(o=t,i=r,u=0;!l&&s&&!n&&u<c.length;u++){var n,a=c[u],p=f.p,y=a[2];t>3?(n=y===r)&&(i=a[(o=a[4])?5:(o=3,3)],a[4]=a[5]=e):a[0]<=p&&((n=t<2&&p<a[1])?(o=0,f.v=r,f.n=a[1]):p<y&&(n=t<3||a[0]>r||r>y)&&(a[4]=t,a[5]=r,f.n=y,o=0))}if(n||t>1)return D;throw l=!0,r}return function(n,c,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===c&&p(c,y),o=c,i=y;(u=o<2?e:i)||!l;){a||(o?o<3?(o>1&&(f.n=-1),p(o,i)):f.n=i:f.v=i);try{if(s=2,a){if(o||(n="next"),u=a[n]){if(!(u=u.call(a,i)))throw TypeError("iterator result is not an object");if(!u.done)return u;i=u.value,o<2&&(o=0)}else 1===o&&(u=a.return)&&u.call(a),o<2&&(i=TypeError("The iterator does not provide a '"+n+"' method"),o=1);a=e}else if((u=(l=f.n<0)?i:t.call(r,f))!==D)break}catch(u){a=e,o=1,i=u}finally{s=1}}return{value:u,done:l}}}(t,n,a),!0),c}var D={};function s(){}function c(){}function l(){}u=Object.getPrototypeOf;var f=[][r]?u(u([][r]())):(i(u={},r,function(){return this}),u),p=l.prototype=s.prototype=Object.create(f);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,i(e,n,"GeneratorFunction")),e.prototype=Object.create(p),e}return c.prototype=l,i(p,"constructor",l),i(l,"constructor",c),c.displayName="GeneratorFunction",i(l,n,"GeneratorFunction"),i(p),i(p,n,"Generator"),i(p,r,function(){return this}),i(p,"toString",function(){return"[object Generator]"}),(o=function(){return{w:a,m:y}})()}function i(e,u,t,r){var n=Object.defineProperty;try{n({},"",{})}catch(e){n=0}i=function(e,u,t,r){function a(u,t){i(e,u,function(e){return this._invoke(u,t,e)})}u?n?n(e,u,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[u]=t:(a("next",0),a("throw",1),a("return",2))},i(e,u,t,r)}function D(e,u,t,r,n,a,o){try{var i=e[a](o),D=i.value}catch(e){return void t(e)}i.done?u(D):Promise.resolve(D).then(r,n)}function s(e){return function(){var u=this,t=arguments;return new Promise(function(r,n){var a=e.apply(u,t);function o(e){D(a,r,n,o,i,"next",e)}function i(e){D(a,r,n,o,i,"throw",e)}o(void 0)})}}function c(e,u){for(var t=0;t<u.length;t++){var r=u[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var u=function(e){if("object"!=r(e)||!e)return e;var u=e[Symbol.toPrimitive];if(void 0!==u){var t=u.call(e,"string");if("object"!=r(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(u)?u:u+""}var f=function(){return e=function e(){!function(e,u){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this,e),this.itemProcessor=new(t(48)),this.zoteroDBAnalyzer=new(t(887))},u=[{key:"initialize",value:(D=s(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:console.log("Initializing menu integration"),this.registerMenuItems();case 1:return e.a(2)}},e,this)})),function(){return D.apply(this,arguments)})},{key:"registerMenuItems",value:function(){console.log("Registered menu items for name normalization")}},{key:"handleNormalizeAction",value:(i=s(o().m(function e(u){var r,a,i,D,s,c,l,f,p,y,m;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:console.log("Handling normalize action for ".concat(u.length," items")),r=[],a=n(u),e.p=1,a.s();case 2:if((i=a.n()).done){e.n=5;break}return D=i.value,e.n=3,this.itemProcessor.processItemCreators(D);case 3:s=e.v,r.push({item:D,results:s});case 4:e.n=2;break;case 5:e.n=7;break;case 6:e.p=6,m=e.v,a.e(m);case 7:return e.p=7,a.f(),e.f(7);case 8:return c=new(t(491)),e.n=9,c.showDialog(u);case 9:l=e.v,f=0;case 10:if(!(f<u.length)){e.n=12;break}return p=u[f],y=l[f],e.n=11,this.itemProcessor.applyNormalizations(p,y.creators);case 11:f++,e.n=10;break;case 12:return e.a(2,{success:!0,processed:u.length})}},e,this,[[1,6,7,8]])})),function(e){return i.apply(this,arguments)})},{key:"performFullLibraryAnalysis",value:(a=s(o().m(function e(){var u,t;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:if("undefined"!=typeof Zotero){e.n=1;break}throw new Error("This feature requires Zotero context");case 1:return console.log("Starting full library analysis for name variants..."),e.p=2,e.n=3,this.zoteroDBAnalyzer.analyzeFullLibrary();case 3:return u=e.v,console.log("Analysis complete: Found ".concat(u.totalVariantGroups," potential variant groups")),e.a(2,u);case 4:throw e.p=4,t=e.v,console.error("Error in full library analysis:",t),t;case 5:return e.a(2)}},e,this,[[2,4]])})),function(){return a.apply(this,arguments)})},{key:"handleFullLibraryAnalysis",value:(r=s(o().m(function e(){var u,t;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.performFullLibraryAnalysis();case 1:return u=e.v,console.log("Full library analysis results:",{totalUniqueSurnames:u.totalUniqueSurnames,totalVariantGroups:u.totalVariantGroups,topSuggestions:u.suggestions.slice(0,10)}),e.a(2,u);case 2:throw e.p=2,t=e.v,console.error("Error handling full library analysis:",t),t;case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return r.apply(this,arguments)})}],u&&c(e.prototype,u),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,u,r,a,i,D}();e.exports&&(e.exports=f)},887:(e,u,t)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,u){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);u&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),t.push.apply(t,r)}return t}function a(e){for(var u=1;u<arguments.length;u++){var t=null!=arguments[u]?arguments[u]:{};u%2?n(Object(t),!0).forEach(function(u){o(e,u,t[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach(function(u){Object.defineProperty(e,u,Object.getOwnPropertyDescriptor(t,u))})}return e}function o(e,u,t){return(u=h(u))in e?Object.defineProperty(e,u,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[u]=t,e}function i(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,u){return function(e){if(Array.isArray(e))return e}(e)||function(e,u){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,n,a,o,i=[],D=!0,s=!1;try{if(a=(t=t.call(e)).next,0===u){if(Object(t)!==t)return;D=!1}else for(;!(D=(r=a.call(t)).done)&&(i.push(r.value),i.length!==u);D=!0);}catch(e){s=!0,n=e}finally{try{if(!D&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(s)throw n}}return i}}(e,u)||f(e,u)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(){var e,u,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",n=t.toStringTag||"@@toStringTag";function a(t,r,n,a){var D=r&&r.prototype instanceof i?r:i,s=Object.create(D.prototype);return c(s,"_invoke",function(t,r,n){var a,i,D,s=0,c=n||[],l=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(u,t){return a=u,i=0,D=e,f.n=t,o}};function p(t,r){for(i=t,D=r,u=0;!l&&s&&!n&&u<c.length;u++){var n,a=c[u],p=f.p,y=a[2];t>3?(n=y===r)&&(D=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=p&&((n=t<2&&p<a[1])?(i=0,f.v=r,f.n=a[1]):p<y&&(n=t<3||a[0]>r||r>y)&&(a[4]=t,a[5]=r,f.n=y,i=0))}if(n||t>1)return o;throw l=!0,r}return function(n,c,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===c&&p(c,y),i=c,D=y;(u=i<2?e:D)||!l;){a||(i?i<3?(i>1&&(f.n=-1),p(i,D)):f.n=D:f.v=D);try{if(s=2,a){if(i||(n="next"),u=a[n]){if(!(u=u.call(a,D)))throw TypeError("iterator result is not an object");if(!u.done)return u;D=u.value,i<2&&(i=0)}else 1===i&&(u=a.return)&&u.call(a),i<2&&(D=TypeError("The iterator does not provide a '"+n+"' method"),i=1);a=e}else if((u=(l=f.n<0)?D:t.call(r,f))!==o)break}catch(u){a=e,i=1,D=u}finally{s=1}}return{value:u,done:l}}}(t,n,a),!0),s}var o={};function i(){}function D(){}function l(){}u=Object.getPrototypeOf;var f=[][r]?u(u([][r]())):(c(u={},r,function(){return this}),u),p=l.prototype=i.prototype=Object.create(f);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,c(e,n,"GeneratorFunction")),e.prototype=Object.create(p),e}return D.prototype=l,c(p,"constructor",l),c(l,"constructor",D),D.displayName="GeneratorFunction",c(l,n,"GeneratorFunction"),c(p),c(p,n,"Generator"),c(p,r,function(){return this}),c(p,"toString",function(){return"[object Generator]"}),(s=function(){return{w:a,m:y}})()}function c(e,u,t,r){var n=Object.defineProperty;try{n({},"",{})}catch(e){n=0}c=function(e,u,t,r){function a(u,t){c(e,u,function(e){return this._invoke(u,t,e)})}u?n?n(e,u,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[u]=t:(a("next",0),a("throw",1),a("return",2))},c(e,u,t,r)}function l(e,u){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=f(e))||u&&e&&"number"==typeof e.length){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,a=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw a}}}}function f(e,u){if(e){if("string"==typeof e)return p(e,u);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?p(e,u):void 0}}function p(e,u){(null==u||u>e.length)&&(u=e.length);for(var t=0,r=Array(u);t<u;t++)r[t]=e[t];return r}function y(e,u,t,r,n,a,o){try{var i=e[a](o),D=i.value}catch(e){return void t(e)}i.done?u(D):Promise.resolve(D).then(r,n)}function m(e){return function(){var u=this,t=arguments;return new Promise(function(r,n){var a=e.apply(u,t);function o(e){y(a,r,n,o,i,"next",e)}function i(e){y(a,r,n,o,i,"throw",e)}o(void 0)})}}function F(e,u){for(var t=0;t<u.length;t++){var r=u[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function h(e){var u=function(e){if("object"!=r(e)||!e)return e;var u=e[Symbol.toPrimitive];if(void 0!==u){var t=u.call(e,"string");if("object"!=r(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(u)?u:u+""}var v=Object.freeze({alex:"alexander",alexander:"alexander",alexandra:"alexandra",alexis:"alexander",ally:"allison",ann:"anne",anna:"anne",annie:"anne",anthony:"anthony",antonio:"antonio",beth:"elizabeth",betsy:"elizabeth",betty:"elizabeth",bill:"william",billy:"william",bob:"robert",bobby:"robert",charles:"charles",charlie:"charles",charlotte:"charlotte",chaz:"charles",che:"ernesto",chuck:"charles",cathy:"catherine",catherine:"catherine",cathie:"catherine",cathryn:"catherine",frank:"francis",francis:"francis",francisco:"francisco",fran:"francis",frederic:"frederick",frederick:"frederick",fred:"frederick",freddie:"frederick",freddy:"frederick",harold:"harold",harry:"harry",hal:"harold",hank:"henry",henry:"henry",jack:"john",jacob:"jacob",jake:"jacob",james:"james",jamie:"james",jen:"jennifer",jenn:"jennifer",jenny:"jennifer",jennifer:"jennifer",jesse:"jessica",jess:"jessica",jessica:"jessica",jim:"james",jimmy:"james",joe:"joseph",joey:"joseph",john:"john",jon:"jonathan",jonathan:"jonathan",jose:"jose",joseph:"joseph",joyce:"joyce",kate:"katherine",katherine:"katherine",kathy:"catherine",katy:"katherine",katie:"katherine",liz:"elizabeth",lizzie:"elizabeth",lou:"louis",louis:"louis",maggie:"margaret",margaret:"margaret",marie:"mary",mary:"mary",megan:"margaret",meg:"margaret",michael:"michael",mick:"michael",mickey:"michael",mike:"michael",manuel:"manuel",manu:"manuel",nancy:"anne",nick:"nicholas",nicholas:"nicholas",nico:"nicholas",paco:"francisco",patricia:"patricia",patty:"patricia",peggy:"margaret",pepe:"jose",rick:"richard",rich:"richard",richard:"richard",ricky:"richard",rob:"robert",robbie:"robert",robert:"robert",ron:"ronald",ronnie:"ronald",ronald:"ronald",rose:"rose",rosie:"rose",sasha:"alexander",sandy:"alexander",ted:"theodore",teddy:"theodore",theodore:"theodore",toni:"antonio",tonya:"antonia",will:"william",willie:"william",william:"william"}),A=function(){return e=function e(){!function(e,u){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this,e),this.candidateFinder=new(t(22)),this.learningEngine=new(t(95))},u=[{key:"analyzeFullLibrary",value:(p=m(s().m(function e(){var u,t,r,n,a,o,i,D,c,f,p,y,m,F,h,v,A,C,E,d,g,b,B,w,S,N,j,k,O,x,P,T,I,z,G,_,M,L,Z,q,U,V,R,K,W,J,$,H,X,Y,Q=arguments;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(u=Q.length>0&&void 0!==Q[0]?Q[0]:null,t=Q.length>1&&void 0!==Q[1]?Q[1]:null,Zotero.debug("ZoteroDBAnalyzer: analyzeFullLibrary started"),"undefined"!=typeof Zotero){e.n=1;break}throw Zotero.debug("ZoteroDBAnalyzer: Zotero undefined, throwing error"),new Error("This method must be run in the Zotero context");case 1:return console.log("Starting full library analysis..."),e.p=2,Zotero.debug("ZoteroDBAnalyzer: Creating search for libraryID: "+Zotero.Libraries.userLibraryID),(r=new Zotero.Search).addCondition("libraryID","is",Zotero.Libraries.userLibraryID),e.n=3,r.search();case 3:if(n=e.v,Zotero.debug("ZoteroDBAnalyzer: Search returned "+(n?n.length:0)+" item IDs"),console.log("Found ".concat(n.length," total items in library")),n&&0!==n.length){e.n=4;break}return console.log("No items found in library"),e.a(2,{surnameFrequencies:{},potentialVariants:[],suggestions:[],totalUniqueSurnames:0,totalVariantGroups:0});case 4:a=[],o=200,Zotero.debug("ZoteroDBAnalyzer: Starting item filtering for creators, total items: "+n.length),console.log("Filtering ".concat(n.length," items to find those with creators...")),i=0;case 5:if(!(i<n.length)){e.n=8;break}return D=n.slice(i,i+o),e.n=6,Zotero.Items.getAsync(D);case 6:c=e.v,f=l(c);try{for(f.s();!(p=f.n()).done;){y=p.value;try{if((m=y.getCreators?y.getCreators():[])&&Array.isArray(m)&&m.length>0){F=m.filter(function(e){return e&&(e.firstName||e.lastName)}),F.length>0&&a.push(y),h=l(m);try{for(h.s();!(v=h.n()).done;)A=v.value,this.addCreatorOccurrence(N,A,y)}catch(e){h.e(e)}finally{h.f()}}}catch(e){console.warn("Error processing item creators:",e)}}}catch(e){f.e(e)}finally{f.f()}u&&u({stage:"filtering_items",processed:i+D.length,total:n.length,percent:Math.round((i+D.length)/n.length*100)});case 7:i+=o,e.n=5;break;case 8:if(Zotero.debug("ZoteroDBAnalyzer: Filtering complete, items with creators: "+a.length),console.log("Found ".concat(a.length," items with valid creators")),0!==a.length){e.n=16;break}return console.log("WARNING: No items with valid creators found!"),console.log("This might indicate:"),console.log("1. Items exist but have no creators"),console.log("2. Creator data is malformed"),console.log("3. Search conditions are too restrictive"),console.log("Trying fallback search to verify database access..."),(C=new Zotero.Search).addCondition("libraryID","is",Zotero.Libraries.userLibraryID),C.addCondition("limit","is",10),e.p=9,e.n=10,C.search();case 10:if(!((E=e.v)&&E.length>0)){e.n=12;break}return e.n=11,Zotero.Items.getAsync(E);case 11:d=e.v,console.log("Fallback found ".concat(d.length," items")),g=l(d.slice(0,3));try{for(g.s();!(b=g.n()).done;){B=b.value;try{w=B.getCreators?B.getCreators():[],console.log('Item "'.concat(B.getField?B.getField("title"):"Unknown",'" has ').concat(w.length," creators:"),w)}catch(e){console.log("Error getting creators for item:",e)}}}catch(e){g.e(e)}finally{g.f()}e.n=13;break;case 12:console.log("Fallback search also found no items");case 13:e.n=15;break;case 14:e.p=14,X=e.v,console.error("Fallback search failed:",X);case 15:Zotero.debug("ZoteroDBAnalyzer: No items with creators found, fallback search initiated");case 16:S=100,N={},j=0,k=0;case 17:if(!(k<n.length)){e.n=21;break}if(!t||!t()){e.n=18;break}throw console.log("Analysis cancelled by user"),new Error("Analysis cancelled");case 18:return O=n.slice(k,k+o),e.n=19,Zotero.Items.getAsync(O);case 19:x=e.v,P=l(x);try{for(P.s();!(T=P.n()).done;){I=T.value;try{z=I.getCreators?I.getCreators():[],G=l(z);try{for(G.s();!(_=G.n()).done;)M=_.value,this.addCreatorOccurrence(N,M,I)}catch(e){G.e(e)}finally{G.f()}}catch(e){console.warn("Error processing item creators:",e)}}}catch(e){P.e(e)}finally{P.f()}j+=O.length,u&&u({stage:"processing_items",processed:j,total:n.length,percent:Math.round(j/n.length*100)});case 20:k+=S,e.n=17;break;case 21:Zotero.debug("ZoteroDBAnalyzer: Starting creator extraction from "+a.length+" items"),console.log("Found ".concat(a.length," items with creators, now extracting creator data...")),L=0;case 22:if(!(L<a.length)){e.n=25;break}if(!t||!t()){e.n=23;break}throw new Error("Analysis cancelled");case 23:Z=a.slice(L,L+S),q=l(Z);try{for(q.s();!(U=q.n()).done;){V=U.value;try{R=V.getCreators?V.getCreators():[],K=l(R);try{for(K.s();!(W=K.n()).done;)J=W.value,this.addCreatorOccurrence(N,J,V)}catch(e){K.e(e)}finally{K.f()}}catch(e){console.warn("Error processing item creators:",e)}}}catch(e){q.e(e)}finally{q.f()}u&&u({stage:"extracting_creators",processed:L+Z.length,total:a.length,percent:Math.round((L+Z.length)/a.length*100)});case 24:L+=S,e.n=22;break;case 25:return $=Object.values(N),Zotero.debug("ZoteroDBAnalyzer: Extracted "+$.length+" unique creators"),console.log("Found ".concat($.length," unique creator combinations")),$.length>0?(Zotero.debug("ZoteroDBAnalyzer: Sample creators: "+JSON.stringify($.slice(0,3))),console.log("Sample creators:",$.slice(0,5))):(Zotero.debug("ZoteroDBAnalyzer: WARNING - No creators extracted at all"),console.log("WARNING: No creators found! This indicates an issue with creator extraction.")),Zotero.debug("ZoteroDBAnalyzer: Starting analyzeCreators with "+$.length+" creators"),e.n=26,this.analyzeCreators($,u,t);case 26:return H=e.v,Zotero.debug("ZoteroDBAnalyzer: analyzeCreators completed, suggestions count: "+(H.suggestions?H.suggestions.length:0)),console.log("Analysis complete: processed ".concat($.length," unique creator entries")),e.a(2,H);case 27:if(e.p=27,Y=e.v,console.error("Error in database analysis:",Y),"Analysis cancelled"!==Y.message){e.n=28;break}throw Y;case 28:return e.a(2,{surnameFrequencies:{},potentialVariants:[],suggestions:[],totalUniqueSurnames:0,totalVariantGroups:0})}},e,this,[[9,14],[2,27]])})),function(){return p.apply(this,arguments)})},{key:"addCreatorOccurrence",value:function(e,u,t){if(u&&(u.firstName||u.lastName)){var r="".concat(u.firstName||"","|").concat(u.lastName||"","|").concat(u.fieldMode||0);if(!e[r]){var n=this.parseName("".concat(u.firstName||""," ").concat(u.lastName||"").trim()||u.lastName||"");e[r]={key:r,firstName:u.firstName||"",lastName:u.lastName||"",fieldMode:u.fieldMode||0,count:0,items:[],parsedName:n}}if(e[r].count=(e[r].count||0)+1,t){var a=this.buildItemSummary(t);a&&(e[r].items||[]).length<25&&e[r].items.push(a)}}}},{key:"buildItemSummary",value:function(e){if(!e)return null;try{var u="function"==typeof e.getField?e.getField.bind(e):null,t=u?u("title"):e.title||"",r=u?u("date"):e.date||"",n=this.extractYear(r),a="function"==typeof e.getCreators?(e.getCreators()||[]).length:void 0;return{id:e.id||null,key:e.key||null,title:t||"Untitled",date:r||"",year:n,itemType:e.itemType||(u?u("itemType"):""),creatorsCount:a}}catch(e){return console.warn("Unable to summarize item for creator mapping:",e),null}}},{key:"extractYear",value:function(e){if(!e||"string"!=typeof e)return"";var u=e.match(/(\d{4})/);return u?u[1]:""}},{key:"analyzeCreators",value:(f=m(s().m(function e(u){var t,r,n,a,o,i,D,c,f,p,y,m,F,h,v,A=arguments;return s().w(function(e){for(;;)if(0===e.n){t=A.length>1&&void 0!==A[1]?A[1]:null,r=A.length>2&&void 0!==A[2]?A[2]:null,Zotero.debug("ZoteroDBAnalyzer: analyzeCreators started with "+(u?u.length:0)+" creators"),n={},a={},o=l(u);try{for(o.s();!(i=o.n()).done;)D=i.value,c="".concat(D.firstName," ").concat(D.lastName).trim(),(f=this.parseName(c)).lastName&&(p=f.lastName.toLowerCase().trim(),n[p]=(n[p]||0)+(D.count||1),a[p]=this.mergeItemSummaries(a[p],D.items))}catch(e){o.e(e)}finally{o.f()}return y=Object.keys(n),Zotero.debug("ZoteroDBAnalyzer: Found "+y.length+" unique surnames"),console.log("Analyzing ".concat(y.length," unique surnames for variants...")),(m=this.findVariantsEfficiently(n,t,r)).sort(function(e,u){var t=e.variant1.frequency+e.variant2.frequency;return u.variant1.frequency+u.variant2.frequency-t}),F=this.groupCreatorsBySurnameForVariants(u),h=this.findGivenNameVariantGroups(F),v=this.generateNormalizationSuggestions(m,h,a),e.a(2,{surnameFrequencies:n,potentialVariants:m,suggestions:v,totalUniqueSurnames:y.length,totalVariantGroups:v.length,givenNameVariantGroups:h})}},e,this)})),function(e){return f.apply(this,arguments)})},{key:"findVariantsEfficiently",value:function(e){for(var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=[],n=Object.keys(e).sort(function(u,t){return e[t]-e[u]}),a=Math.min(1e4,5*n.length),o=0,i=0;i<n.length&&o<a;i++){if(t&&t())throw new Error("Analysis cancelled");for(var D=n[i],s=D.length,c=Math.max(3,s-2),l=s+2,f=i+1;f<n.length&&o<a;f++){var p=n[f];if(!(p.length<c||p.length>l)){o++;var y=this.calculateStringSimilarity(D,p);y>=.8&&r.push({variant1:{name:D,frequency:e[D]},variant2:{name:p,frequency:e[p]},similarity:y,recommendedNormalization:e[D]>=e[p]?D:p})}}u&&i%10==0&&u({stage:"analyzing_surnames",processed:i,total:n.length,percent:Math.round(i/n.length*100)})}return Zotero.debug("ZoteroDBAnalyzer: Variant detection complete, compared "+o+" pairs, found "+r.length+" variants"),console.log("Compared ".concat(o," surname pairs, found ").concat(r.length," potential variants")),r}},{key:"groupCreatorsBySurnameForVariants",value:function(e){var u,t={},r=l(e);try{for(r.s();!(u=r.n()).done;){var n=u.value;if(n&&n.lastName){var a=(n.lastName||"").toLowerCase().trim();t[a]||(t[a]=[]),t[a].push(n)}}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"parseGivenNameTokens",value:function(e){var u=(e||"").trim();if(!u)return[];var t,r=u.split(/[\s-]+/).filter(Boolean),n=[],a=l(r);try{for(a.s();!(t=a.n()).done;){var o=t.value,i=o.replace(/[^A-Za-z]/g,"");i&&(this.isLikelyInitialSequence(i,o)?i.toUpperCase().split("").forEach(function(e){n.push({type:"initial",value:e})}):1===i.length?n.push({type:"initial",value:i.toUpperCase()}):n.push({type:"word",value:this.toTitleCase(i)}))}}catch(e){a.e(e)}finally{a.f()}return n}},{key:"isLikelyInitialSequence",value:function(e){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!e)return!1;var t=e.toUpperCase();return!(t.length<2||t.length>4||/[^A-Z]/.test(t)||!/\./.test(u)&&/[AEIOUY]/.test(t))}},{key:"selectCanonicalGivenNameData",value:function(e,u){var t,r=u&&!u.startsWith("initial:")?this.toTitleCase(u):"",n=[],a=-1/0,o=l(e||[]);try{for(o.s();!(t=o.n()).done;){var i,D=t.value,s=((null===(i=D.parsedName)||void 0===i?void 0:i.firstName)||D.firstName||"").trim();if(s){var c=this.parseGivenNameTokens(s);if(0!==c.length){var f=c.some(function(e){return"word"===e.type}),p=(D.count||1)+c.length;f&&(p+=1e3),p>a&&(n=c,a=p)}}}}catch(e){o.e(e)}finally{o.f()}var y,m=n.find(function(e){return"word"===e.type}),F=m?m.value:r,h=[],v=[],A=!1,C=l(n);try{for(C.s();!(y=C.n()).done;){var E=y.value;if("word"===E.type){if(!(A||m&&E.value!==m.value)){A=!0;continue}h.includes(E.value)||h.push(E.value)}else if("initial"===E.type){var d=E.value.toUpperCase();v.includes(d)||v.push(d)}}}catch(e){C.e(e)}finally{C.f()}return{baseWord:F,extraWords:h,initials:v}}},{key:"composeGivenNameFromTokens",value:function(e){var u,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.baseWord||"",n=t.extraWords||[],a=t.initials||[],o=Array.isArray(e)?e:[],i=o.filter(function(e){return e&&"word"===e.type}),D=o.filter(function(e){return e&&"initial"===e.type}),s=i.length>0,c=D.length>0,f=!s&&c,p="",y=[],m=[],F=l(o);try{for(F.s();!(u=F.n()).done;){var h=u.value;if("word"===h.type)p?y.includes(h.value)||y.push(h.value):p=h.value;else if("initial"===h.type){var v=h.value.toUpperCase();m.includes(v)||m.push(v)}}}catch(e){F.e(e)}finally{F.f()}!p&&r&&(p=r);var A=p?p.charAt(0).toUpperCase():"";!p&&m.length>0&&(p="".concat(m[0],"."),m.shift()),f&&n.forEach(function(e){e&&(y.includes(e)||e===p||y.push(e))});var C=[],E=new Set,d=function(e){if(e){var u=e.toUpperCase();u!==A||E.has(u)?E.has(u)||(C.push("".concat(u,".")),E.add(u)):E.add(u)}};m.forEach(function(e){return d(e)}),f&&a.forEach(function(e){return d(e)});var g=[];return p&&g.push(p),g.push.apply(g,y),g.push.apply(g,C),g.join(" ").replace(/\s+/g," ").trim()}},{key:"findGivenNameVariantGroups",value:function(e){for(var u=[],t=0,r=Object.entries(e);t<r.length;t++){var n=D(r[t],2),a=n[0],o=n[1];if(o&&!(o.length<2)){var s=this.findGivenNameVariantsForSurname(a,o);s.length>0&&u.push.apply(u,i(s))}}return u}},{key:"findGivenNameVariantsForSurname",value:function(e,u){var t,r=this,n=[],a=new Map,o=new Map,i=(e||"").trim(),s=i.toLowerCase(),c=this.toTitleCase(i),f=l(u);try{for(f.s();!(t=f.n()).done;){var p,y,m=t.value,F=[null===(p=m.parsedName)||void 0===p?void 0:p.firstName,null===(y=m.parsedName)||void 0===y?void 0:y.middleName].filter(function(e){return e&&"string"==typeof e&&e.trim().length>0}).join(" ").trim(),h=(m.firstName||"").trim(),v=F||h;if(v){var A=this.normalizeGivenName(v)||v.toLowerCase();a.has(A)||a.set(A,[]),a.get(A).push(m);var C="".concat(v,"|").concat(m.lastName);o.has(C)||o.set(C,m.items||[])}}}catch(e){f.e(e)}finally{f.f()}this.mergeInitialBuckets(a);var E,d=l(a.entries());try{for(d.s();!(E=d.n()).done;){var g=D(E.value,2),b=g[0],B=g[1];if(!(B.length<2)){var w,S=this.selectCanonicalGivenNameData(B,b),N=new Map,j=0,k=l(B);try{for(k.s();!(w=k.n()).done;){var O,x,P,T=w.value,I=[null===(O=T.parsedName)||void 0===O?void 0:O.firstName,null===(x=T.parsedName)||void 0===x?void 0:x.middleName].filter(function(e){return e&&"string"==typeof e&&e.trim().length>0}).join(" ").trim()||(T.firstName||"").trim(),z=this.parseGivenNameTokens(I),G=this.composeGivenNameFromTokens(z,S)||S.baseWord||I,_=((null===(P=T.parsedName)||void 0===P?void 0:P.lastName)||T.lastName||i).trim(),M=this.toTitleCase(_),L="".concat(G,"|").concat(M).toLowerCase(),Z=N.get(L)||{firstName:G,lastName:M,frequency:0,items:[],name:"".concat(G," ").concat(M).trim()};Z.frequency+=T.count||1,j+=T.count||1,Z.lastName=M,Z.name="".concat(Z.firstName," ").concat(M).trim();var q="".concat(I,"|").concat(T.lastName);o.has(q)&&(Z.items=this.mergeItemSummaries(Z.items,o.get(q))),N.set(L,Z)}}catch(e){k.e(e)}finally{k.f()}if(!(N.size<2)){var U=Array.from(N.values()).map(function(e){var u=r.toTitleCase(e.lastName||c);return Object.assign({},e,{lastName:u,name:"".concat(e.firstName," ").concat(u).trim()})}),V=this.buildGivenNameRecommendation(U,c,S);n.push({surname:c,surnameKey:s,normalizedKey:b,variants:U,totalFrequency:j,recommendedFirstName:V.firstName,recommendedFullName:V.fullName})}}}}catch(e){d.e(e)}finally{d.f()}return n}},{key:"normalizeGivenName",value:function(e){var u=e.trim();if(!u)return"";var t=u.split(/[\s-]+/).filter(Boolean),r=t.map(function(e){return e.replace(/\./g,"")});if(0===r.length)return"";var n=r[0].toLowerCase();return r.every(function(e){return 1===e.length})?"initial:".concat(r.join("")):1===r.length&&this.isLikelyInitialSequence(r[0],t[0])?"initial:".concat(r[0].toUpperCase()):v[n]?v[n]:n}},{key:"mergeItemSummaries",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!u||0===u.length)return e;var t,r=new Map,n=l(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(a){var o=a.key||a.id||JSON.stringify(a);if(r.has(o)||r.set(o,a),r.size>=25)break}}}catch(e){n.e(e)}finally{n.f()}var i,D=l(u);try{for(D.s();!(i=D.n()).done;){var s=i.value;if(s){var c=s.key||s.id||JSON.stringify(s);if(!r.has(c)&&r.size<25&&r.set(c,s),r.size>=25)break}}}catch(e){D.e(e)}finally{D.f()}return Array.from(r.values())}},{key:"mergeInitialBuckets",value:function(e){var u=Array.from(e.keys()).filter(function(e){return!e.startsWith("initial:")});if(0===u.length)return e;for(var t=function(){var t=D(n[r],2),a=t[0],o=t[1];if(!a.startsWith("initial:"))return 0;var i=a.replace("initial:","");if(!i)return 0;var s=i.charAt(0).toLowerCase(),c=u.find(function(e){return e.charAt(0).toLowerCase()===s});if(c){var l=e.get(c);o.forEach(function(e){return l.push(e)}),e.delete(a)}},r=0,n=Array.from(e.entries());r<n.length;r++)t();return e}},{key:"buildGivenNameRecommendation",value:function(e,u){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||0===e.length)return{firstName:"",fullName:u||""};var r,n=function(e,u){u&&(e.includes(u)||e.push(u))},a=t.baseWord?this.toTitleCase(t.baseWord):"",o=[],i=[],D=!1,s=l(e);try{for(s.s();!(r=s.n()).done;){var c=r.value,f=this.parseGivenNameTokens(c.firstName||""),p=f.some(function(e){return"word"===e.type}),y=f.some(function(e){return"initial"===e.type});p&&!y&&(D=!0);var m,F=!1,h=l(f);try{for(h.s();!(m=h.n()).done;){var v=m.value;"word"===v.type?F?n(o,v.value):(F=!0,a||(a=v.value)):"initial"===v.type&&n(i,v.value.toUpperCase())}}catch(e){h.e(e)}finally{h.f()}}}catch(e){s.e(e)}finally{s.f()}if((t.extraWords||[]).forEach(function(e){return n(o,e)}),D||(t.initials||[]).forEach(function(e){return n(i,e.toUpperCase())}),!a){var A=this.parseGivenNameTokens(e[0].firstName||""),C=A.find(function(e){return"word"===e.type});if(C)a=C.value;else{var E=A.find(function(e){return"initial"===e.type});if(E){var d=E.value.toUpperCase();a="".concat(d,".");var g=i.indexOf(d);-1!==g&&i.splice(g,1)}}}var b=a?a.charAt(0).toUpperCase():"";if(b){var B=i.indexOf(b);-1!==B&&i.splice(B,1)}D&&(i.length=0);var w=[];a&&w.push(a),w.push.apply(w,o),i.forEach(function(e){return w.push("".concat(e,"."))});var S=w.filter(Boolean).join(" ").replace(/\s+/g," ").trim(),N=this.toTitleCase(u||"");return{firstName:S,fullName:N?"".concat(S," ").concat(N).trim():S}}},{key:"scoreGivenNameVariant",value:function(e){var u;if(!e)return 0;var t=e.frequency||0,r=(e.firstName||"").trim();if(!r)return t;var n=r.replace(/\./g,"");/[a-z]{2,}/i.test(n)&&(t+=1e3),r.includes(".")||(t+=200);var a=(null===(u=n.split(/[\s-]+/)[0])||void 0===u?void 0:u.toLowerCase())||"";return v[a]&&(t+=50),t+Math.min(n.length,20)}},{key:"toTitleCase",value:function(e){return e?e.split(/\s+/).filter(Boolean).map(function(e){return e.toLowerCase().replace(/(^|['\x2D`])((?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088F\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5C\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDC-\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7DC\uA7F1-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD40-\uDD59\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC7\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDB0-\uDDDB\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDEA0-\uDEB8\uDEBB-\uDED3\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF2\uDFF3]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDEC0-\uDEDE\uDEE0-\uDEE2\uDEE4\uDEE5\uDEE7-\uDEED\uDEF0-\uDEF4\uDEFE\uDEFF\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]))/g,function(e,u,t){return u+t.toUpperCase()})}).join(" "):""}},{key:"parseName",value:function(e){return(new(t(889))).parse(e)}},{key:"calculateStringSimilarity",value:function(e,u){var t=[],r=e.length,n=u.length;if(0===r)return 0===n?1:0;if(0===n)return 0;for(var a=0;a<=n;a++)t[a]=[a];for(var o=0;o<=r;o++)t[0][o]=o;for(var i=1;i<=n;i++)for(var D=1;D<=r;D++)u.charAt(i-1)===e.charAt(D-1)?t[i][D]=t[i-1][D-1]:t[i][D]=Math.min(t[i-1][D-1]+1,t[i][D-1]+1,t[i-1][D]+1);return 1-t[n][r]/Math.max(r,n)}},{key:"generateNormalizationSuggestions",value:function(e){var u=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Zotero.debug("ZoteroDBAnalyzer: generateNormalizationSuggestions called with "+(e?e.length:0)+" surname variants and "+(t?t.length:0)+" given-name groups");var n,a=[],o=new Set,i=l(e||[]);try{for(i.s();!(n=i.n()).done;){var D=n.value,s=D.variant1.name,c=D.variant2.name;if(!o.has(s)&&!o.has(c)){var f={type:"surname",primary:D.recommendedNormalization,variants:[{name:D.variant1.name,frequency:D.variant1.frequency,items:r[D.variant1.name]||[]},{name:D.variant2.name,frequency:D.variant2.frequency,items:r[D.variant2.name]||[]}],similarity:D.similarity,surnameKey:(D.recommendedNormalization||"").toLowerCase()};this.enrichSuggestionWithGivenNameData(f,t),a.push(f),o.add(s),o.add(c)}}}catch(e){i.e(e)}finally{i.f()}var p,y=l(t||[]);try{var m=function(){var e=p.value;if(!e||!e.surname||!Array.isArray(e.variants)||e.variants.length<2)return 1;var t,r=e.surnameKey||e.surname.toLowerCase(),n=a.find(function(u){return"given-name"===u.type&&(u.surnameKey||(u.surname||"").toLowerCase())===r&&u.normalizedGivenNameKey===e.normalizedKey}),o=e.variants.map(function(t){var r=u.toTitleCase(t.lastName||e.surname);return{name:"".concat(t.firstName," ").concat(r).trim(),firstName:t.firstName,lastName:r,frequency:t.frequency,items:t.items||[]}});n?(n.variants=u.mergeVariantLists(n.variants,o),n.totalFrequency=(n.totalFrequency||0)+(e.totalFrequency||0),n.surname=e.surname,n.surnameKey=r,n.normalizedGivenNameKey=e.normalizedKey,!n.recommendedFullName&&e.recommendedFullName&&(n.recommendedFullName=e.recommendedFullName)):a.push({type:"given-name",surname:e.surname,surnameKey:r,normalizedGivenNameKey:e.normalizedKey,variants:o,totalFrequency:e.totalFrequency,recommendedFirstName:e.recommendedFirstName,recommendedFullName:e.recommendedFullName,primary:e.recommendedFullName||"".concat((null===(t=o[0])||void 0===t?void 0:t.name)||"")})};for(y.s();!(p=y.n()).done;)m()}catch(e){y.e(e)}finally{y.f()}return Zotero.debug("ZoteroDBAnalyzer: Generated "+a.length+" normalization suggestions (combined)"),a}},{key:"enrichSuggestionWithGivenNameData",value:function(e,u){if(!e||!u||0===u.length)return e;var t=(e.surnameKey||e.primary||"").toLowerCase();if(!t)return e;var r=u.find(function(e){return e&&(e.surnameKey||(e.surname||"").toLowerCase())===t});return r?(e.relatedGivenNameVariants=r.variants.map(function(e){return{firstName:e.firstName,frequency:e.frequency,items:e.items||[]}}),e.relatedGivenNameKey=r.normalizedKey,e.relatedGivenNameTotal=r.totalFrequency,e):e}},{key:"mergeVariantLists",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!u||0===u.length)return e||[];var t,r=new Map,n=l(e||[]);try{for(n.s();!(t=n.n()).done;){var o=t.value;if(o){var D=o.name?o.name.toLowerCase():JSON.stringify(o);r.has(D)||r.set(D,a(a({},o),{},{items:o.items?i(o.items):[]}))}}}catch(e){n.e(e)}finally{n.f()}var s,c=l(u);try{for(c.s();!(s=c.n()).done;){var f=s.value;if(f){var p=f.name?f.name.toLowerCase():JSON.stringify(f);if(r.has(p)){var y=r.get(p);y.frequency=(y.frequency||0)+(f.frequency||0),y.items=this.mergeItemSummaries(y.items,f.items)}else r.set(p,a(a({},f),{},{items:f.items?i(f.items):[]}))}}}catch(e){c.e(e)}finally{c.f()}return Array.from(r.values()).sort(function(e,u){return(u.frequency||0)-(e.frequency||0)})}},{key:"getNormalizationForSurname",value:(c=m(s().m(function e(u){var t,r,n,a,i;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if("undefined"!=typeof Zotero){e.n=1;break}return e.a(2,null);case 1:return e.n=2,this.analyzeFullLibrary();case 2:t=e.v,r=l(t.potentialVariants),e.p=3,r.s();case 4:if((n=r.n()).done){e.n=6;break}if((a=n.value).variant1.name!==u&&a.variant2.name!==u){e.n=5;break}return e.a(2,{recommended:a.recommendedNormalization,alternatives:[a.variant1.name,a.variant2.name],similarity:a.similarity,frequencies:o(o({},a.variant1.name,a.variant1.frequency),a.variant2.name,a.variant2.frequency)});case 5:e.n=4;break;case 6:e.n=8;break;case 7:e.p=7,i=e.v,r.e(i);case 8:return e.p=8,r.f(),e.f(8);case 9:return e.a(2,null)}},e,this,[[3,7,8,9]])})),function(e){return c.apply(this,arguments)})},{key:"applyNormalizationSuggestions",value:(n=m(s().m(function e(u){var t,r,n,a,o,i,D,c,f,p,y,m,F,h=arguments;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=h.length>1&&void 0!==h[1]&&h[1],"undefined"!=typeof Zotero){e.n=1;break}throw new Error("This method must be run in the Zotero context");case 1:r={totalSuggestions:u.length,applied:0,skipped:0,errors:0},e.p=2,n=l(u),e.p=3,n.s();case 4:if((a=n.n()).done){e.n=19;break}if(o=a.value,e.p=5,f=t){e.n=7;break}return e.n=6,this.confirmNormalization(o);case 6:f=e.v;case 7:if(!f){e.n=15;break}i=l(o.variants),e.p=8,i.s();case 9:if((D=i.n()).done){e.n=11;break}if((c=D.value).name===o.primary){e.n=10;break}return e.n=10,this.learningEngine.storeMapping(c.name,o.primary,o.similarity);case 10:e.n=9;break;case 11:e.n=13;break;case 12:e.p=12,p=e.v,i.e(p);case 13:return e.p=13,i.f(),e.f(13);case 14:r.applied++,e.n=16;break;case 15:r.skipped++;case 16:e.n=18;break;case 17:e.p=17,y=e.v,console.error("Error applying normalization:",y),r.errors++;case 18:e.n=4;break;case 19:e.n=21;break;case 20:e.p=20,m=e.v,n.e(m);case 21:return e.p=21,n.f(),e.f(21);case 22:e.n=24;break;case 23:e.p=23,F=e.v,console.error("Error in applyNormalizationSuggestions:",F),r.errors++;case 24:return e.a(2,r)}},e,this,[[8,12,13,14],[5,17],[3,20,21,22],[2,23]])})),function(e){return n.apply(this,arguments)})},{key:"confirmNormalization",value:(r=m(s().m(function e(){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,!0)},e)})),function(){return r.apply(this,arguments)})}],u&&F(e.prototype,u),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,u,r,n,c,f,p}();e.exports&&(e.exports=A)},889:e=>{function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function t(e,u){for(var t=0;t<u.length;t++){var n=u[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r(n.key),n)}}function r(e){var t=function(e){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}var n=function(){return e=function e(){!function(e,u){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this,e),this.prefixes=["van","de","la","von","del","di","du","le","lo","da","des","dos","das","el","al"],this.suffixes=["Jr","Sr","II","III","IV","PhD","MD","Jr.","Sr."],this.initialPattern=/^[A-Z]\.?$/,this.initialsPattern=/^[A-Z]\.[A-Z]\.?$/},(u=[{key:"parse",value:function(e){var u=this,t=e||"",r=(t||"").trim();if(r.includes(",")){var n=r.split(",").map(function(e){return e.trim()}).filter(function(e){return e.length>0});if(n.length>=2){var a=n[0],o=n.slice(1).join(" ").trim();/(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088F\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5C\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDC-\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7DC\uA7F1-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD40-\uDD59\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC7\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDB0-\uDDDB\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDEA0-\uDEB8\uDEBB-\uDED3\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF2\uDFF3]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDEC0-\uDEDE\uDEE0-\uDEE2\uDEE4\uDEE5\uDEE7-\uDEED\uDEF0-\uDEF4\uDEFE\uDEFF\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79])/.test(a)&&/(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088F\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5C\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDC-\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7DC\uA7F1-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD40-\uDD59\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC7\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDB0-\uDDDB\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDEA0-\uDEB8\uDEBB-\uDED3\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF2\uDFF3]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDEC0-\uDEDE\uDEE0-\uDEE2\uDEE4\uDEE5\uDEE7-\uDEED\uDEF0-\uDEF4\uDEFE\uDEFF\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79])/.test(o)&&(r="".concat(o," ").concat(a).trim())}}var i=r.replace(/[ ,\s]+$/,"").split(/\s+/),D={firstName:"",middleName:"",lastName:"",prefix:"",suffix:"",original:t};if(1===i.length&&""!==i[0])return this.prefixes.includes(i[0].toLowerCase())?D.prefix=i[0]:D.lastName=i[0],D;if(1===i.length&&""===i[0])return D;if(i.length>=2){D.firstName=this.stripTrailingPeriodIfName(i[0]);for(var s=1;s<i.length-1&&this.prefixes.includes(i[s].toLowerCase());)D.prefix?D.prefix="".concat(D.prefix," ").concat(i[s]):D.prefix=i[s],s++;D.prefix&&s<i.length-1&&this.isNextWordForPrefix(D.prefix,i[s])&&(D.prefix="".concat(D.prefix," ").concat(i[s]),s++);for(var c=i.length-1;c>s&&this.suffixes.some(function(e){return i[c].toLowerCase()===e.toLowerCase()||i[c].toLowerCase()===e.toLowerCase()+"."});)D.suffix?D.suffix="".concat(i[c]," ").concat(D.suffix):D.suffix=i[c],c--;if(c>=s&&(D.lastName=i[c]),s<c){var l=i.slice(s,c);l.length>0&&(D.middleName=l.map(function(e){return u.stripTrailingPeriodIfName(e)}).join(" "))}}return D.firstName=this.stripTrailingPeriodIfName(D.firstName),D.middleName=this.stripTrailingPeriodIfName(D.middleName),D.lastName=this.stripTrailingPeriodIfName(D.lastName),D}},{key:"isNextWordForPrefix",value:function(e,u){return!!["del","de","da","das","dos","do","du","des","di"].includes(e)&&/^[A-Z][a-zA-Z]+$/.test(u)&&u.length>1}},{key:"stripTrailingPeriodIfName",value:function(e){if(!e||"string"!=typeof e)return e||"";var u=e.trim();if(!u.endsWith("."))return u;var t=u.slice(0,-1);return t.length<2||t.includes(".")?u:/[A-Za-z]/.test(t)&&/[AEIOUYaeiouy]/.test(t)?t:u}}])&&t(e.prototype,u),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,u}();e.exports&&(e.exports=n)}},u={};function t(r){var n=u[r];if(void 0!==n)return n.exports;var a=u[r]={exports:{}};return e[r](a,a.exports,t),a.exports}t.n=e=>{var u=e&&e.__esModule?()=>e.default:()=>e;return t.d(u,{a:u}),u},t.d=(e,u)=>{for(var r in u)t.o(u,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:u[r]})},t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=(e,u)=>Object.prototype.hasOwnProperty.call(e,u),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{"use strict";t.r(r),t.d(r,{BatchProcessor:()=>g.a,CandidateFinder:()=>l.a,DataManager:()=>B.a,GLINERHandler:()=>p.a,ItemProcessor:()=>m.a,LearningEngine:()=>s.a,MenuIntegration:()=>h.a,NERProcessor:()=>u.a,NERWorker:()=>S.a,NameParser:()=>a.a,NormalizerDialog:()=>E.a,VariantGenerator:()=>i.a,ZoteroDBAnalyzer:()=>A.a,default:()=>j});var e=t(388),u=t.n(e),n=t(889),a=t.n(n),o=t(441),i=t.n(o),D=t(95),s=t.n(D),c=t(22),l=t.n(c),f=t(208),p=t.n(f),y=t(48),m=t.n(y),F=t(886),h=t.n(F),v=t(887),A=t.n(v),C=t(491),E=t.n(C),d=t(672),g=t.n(d),b=t(588),B=t.n(b),w=t(827),S=t.n(w),N={NERProcessor:u(),NameParser:a(),VariantGenerator:i(),LearningEngine:s(),CandidateFinder:l(),GLINERHandler:p(),ItemProcessor:m(),MenuIntegration:h(),ZoteroDBAnalyzer:A(),NormalizerDialog:E(),BatchProcessor:g(),DataManager:B(),NERWorker:S()};"undefined"!=typeof window&&(window.ZoteroNER=N);const j=N})(),r})());